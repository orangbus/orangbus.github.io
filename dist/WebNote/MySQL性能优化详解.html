<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL性能优化详解【精华篇】 | OrangBus</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="shortcut icon" href="/orangbus.ico" type="image/jpg">
    <script><script>
			var _hmt = _hmt || [];
			(function() {
			  var hm = document.createElement("script");
			  hm.src = "https://hm.baidu.com/hm.js?75a195c58b50e00357efe9066f49f8b0";
			  var s = document.getElementsByTagName("script")[0]; 
			  s.parentNode.insertBefore(hm, s);
			})();
			</script>
			</script>
    <meta name="description" content="分享生活高效技能,保持勇敢，坚持有趣，生命不息，折腾不止！">
    <meta property="article:modified_time" content="2022-08-06T06:00:03.000Z">
    <meta property="og:site_name" content="OrangBus">
    <meta property="og:title" content="MySQL性能优化详解【精华篇】">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/WebNote/MySQL%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E8%AF%A6%E8%A7%A3.html">
    <meta name="twitter:title" content="MySQL性能优化详解【精华篇】">
    <meta name="twitter:url" content="/WebNote/MySQL%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E8%AF%A6%E8%A7%A3.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="keywords" content="html,css,jquery,thinkphp,laravel,docker,linux,manjaro">
    <meta name="auther" content="OrangBus">
    <link rel="preload" href="/assets/css/0.styles.8405cd42.css" as="style"><link rel="preload" href="/assets/js/app.0b830e2b.js" as="script"><link rel="preload" href="/assets/js/3.6c5e3284.js" as="script"><link rel="preload" href="/assets/js/134.2ddb71dd.js" as="script"><link rel="prefetch" href="/assets/js/10.013fb38f.js"><link rel="prefetch" href="/assets/js/100.1c6e85cf.js"><link rel="prefetch" href="/assets/js/101.5cb2972e.js"><link rel="prefetch" href="/assets/js/102.14cef0e9.js"><link rel="prefetch" href="/assets/js/103.8138b32a.js"><link rel="prefetch" href="/assets/js/104.1658ba4d.js"><link rel="prefetch" href="/assets/js/105.30de147f.js"><link rel="prefetch" href="/assets/js/106.43f5913c.js"><link rel="prefetch" href="/assets/js/107.aa63ed8b.js"><link rel="prefetch" href="/assets/js/108.a20cab88.js"><link rel="prefetch" href="/assets/js/109.87d28bed.js"><link rel="prefetch" href="/assets/js/11.8d19373b.js"><link rel="prefetch" href="/assets/js/110.e8557e5c.js"><link rel="prefetch" href="/assets/js/111.1b4dd383.js"><link rel="prefetch" href="/assets/js/112.86ed658f.js"><link rel="prefetch" href="/assets/js/113.88210ae1.js"><link rel="prefetch" href="/assets/js/114.02e160d1.js"><link rel="prefetch" href="/assets/js/115.fa27b050.js"><link rel="prefetch" href="/assets/js/116.2ecfc060.js"><link rel="prefetch" href="/assets/js/117.73af2fc8.js"><link rel="prefetch" href="/assets/js/118.9f548ef4.js"><link rel="prefetch" href="/assets/js/119.0fb50863.js"><link rel="prefetch" href="/assets/js/12.da5b0c4e.js"><link rel="prefetch" href="/assets/js/120.4eb8d56e.js"><link rel="prefetch" href="/assets/js/121.db9f6a26.js"><link rel="prefetch" href="/assets/js/122.563648f6.js"><link rel="prefetch" href="/assets/js/123.6fb4a660.js"><link rel="prefetch" href="/assets/js/124.d61cec0e.js"><link rel="prefetch" href="/assets/js/125.7b073096.js"><link rel="prefetch" href="/assets/js/126.fe856895.js"><link rel="prefetch" href="/assets/js/127.d1eee1a0.js"><link rel="prefetch" href="/assets/js/128.bca88fae.js"><link rel="prefetch" href="/assets/js/129.322185d4.js"><link rel="prefetch" href="/assets/js/13.481eda0c.js"><link rel="prefetch" href="/assets/js/130.7117293d.js"><link rel="prefetch" href="/assets/js/131.97896846.js"><link rel="prefetch" href="/assets/js/132.dde09783.js"><link rel="prefetch" href="/assets/js/133.7fd8142b.js"><link rel="prefetch" href="/assets/js/135.5d747749.js"><link rel="prefetch" href="/assets/js/136.6cf7219c.js"><link rel="prefetch" href="/assets/js/137.4746d729.js"><link rel="prefetch" href="/assets/js/138.3c5a9696.js"><link rel="prefetch" href="/assets/js/139.7dc10219.js"><link rel="prefetch" href="/assets/js/14.28cc5602.js"><link rel="prefetch" href="/assets/js/140.243ce755.js"><link rel="prefetch" href="/assets/js/141.be369aa1.js"><link rel="prefetch" href="/assets/js/142.cf7c0f4b.js"><link rel="prefetch" href="/assets/js/143.9cfcd707.js"><link rel="prefetch" href="/assets/js/144.12d97da3.js"><link rel="prefetch" href="/assets/js/145.67e4aabd.js"><link rel="prefetch" href="/assets/js/146.16afa280.js"><link rel="prefetch" href="/assets/js/147.5038ee1d.js"><link rel="prefetch" href="/assets/js/148.5689de1e.js"><link rel="prefetch" href="/assets/js/149.aa7c12df.js"><link rel="prefetch" href="/assets/js/15.4e035f99.js"><link rel="prefetch" href="/assets/js/150.631c9874.js"><link rel="prefetch" href="/assets/js/151.a37687c2.js"><link rel="prefetch" href="/assets/js/152.c21f07a6.js"><link rel="prefetch" href="/assets/js/153.533b68fc.js"><link rel="prefetch" href="/assets/js/154.410e0fad.js"><link rel="prefetch" href="/assets/js/155.d40bbde1.js"><link rel="prefetch" href="/assets/js/156.12b89d65.js"><link rel="prefetch" href="/assets/js/157.81d3e8fa.js"><link rel="prefetch" href="/assets/js/158.2bf7923d.js"><link rel="prefetch" href="/assets/js/159.8fc46e81.js"><link rel="prefetch" href="/assets/js/16.5d530c6e.js"><link rel="prefetch" href="/assets/js/160.751b6442.js"><link rel="prefetch" href="/assets/js/161.32bac2ab.js"><link rel="prefetch" href="/assets/js/162.123f3929.js"><link rel="prefetch" href="/assets/js/163.e33ccf12.js"><link rel="prefetch" href="/assets/js/164.6a576868.js"><link rel="prefetch" href="/assets/js/165.269a81a4.js"><link rel="prefetch" href="/assets/js/166.eb35ff2e.js"><link rel="prefetch" href="/assets/js/167.7c5cdb02.js"><link rel="prefetch" href="/assets/js/168.9df61937.js"><link rel="prefetch" href="/assets/js/169.c87ad301.js"><link rel="prefetch" href="/assets/js/17.4b5f9197.js"><link rel="prefetch" href="/assets/js/170.d3f0931b.js"><link rel="prefetch" href="/assets/js/18.f477282f.js"><link rel="prefetch" href="/assets/js/19.8ea0b8e4.js"><link rel="prefetch" href="/assets/js/2.33998d9a.js"><link rel="prefetch" href="/assets/js/20.30b9f95b.js"><link rel="prefetch" href="/assets/js/21.a6649bae.js"><link rel="prefetch" href="/assets/js/22.b463b197.js"><link rel="prefetch" href="/assets/js/23.e77dc139.js"><link rel="prefetch" href="/assets/js/24.d95d13f9.js"><link rel="prefetch" href="/assets/js/25.461bdc07.js"><link rel="prefetch" href="/assets/js/26.1d1a614d.js"><link rel="prefetch" href="/assets/js/27.3ec4bc59.js"><link rel="prefetch" href="/assets/js/28.b9308478.js"><link rel="prefetch" href="/assets/js/29.33823998.js"><link rel="prefetch" href="/assets/js/30.e83dfc1c.js"><link rel="prefetch" href="/assets/js/31.5281c715.js"><link rel="prefetch" href="/assets/js/32.dac26c8f.js"><link rel="prefetch" href="/assets/js/33.edec01e0.js"><link rel="prefetch" href="/assets/js/34.a39e0d16.js"><link rel="prefetch" href="/assets/js/35.a602d707.js"><link rel="prefetch" href="/assets/js/36.bc0a6f2e.js"><link rel="prefetch" href="/assets/js/37.fe4aa902.js"><link rel="prefetch" href="/assets/js/38.b6eca894.js"><link rel="prefetch" href="/assets/js/39.60ef38e7.js"><link rel="prefetch" href="/assets/js/4.7d30153c.js"><link rel="prefetch" href="/assets/js/40.7d2f4f03.js"><link rel="prefetch" href="/assets/js/41.f7c16065.js"><link rel="prefetch" href="/assets/js/42.85c4e78e.js"><link rel="prefetch" href="/assets/js/43.0dcb6e18.js"><link rel="prefetch" href="/assets/js/44.e0e8f64a.js"><link rel="prefetch" href="/assets/js/45.64813a79.js"><link rel="prefetch" href="/assets/js/46.46b331ee.js"><link rel="prefetch" href="/assets/js/47.c35ff3b6.js"><link rel="prefetch" href="/assets/js/48.b6a2e830.js"><link rel="prefetch" href="/assets/js/49.860962f7.js"><link rel="prefetch" href="/assets/js/5.978da17c.js"><link rel="prefetch" href="/assets/js/50.29119c64.js"><link rel="prefetch" href="/assets/js/51.76d64cf2.js"><link rel="prefetch" href="/assets/js/52.bc3dccec.js"><link rel="prefetch" href="/assets/js/53.a17c28fd.js"><link rel="prefetch" href="/assets/js/54.b2127012.js"><link rel="prefetch" href="/assets/js/55.e28d5a25.js"><link rel="prefetch" href="/assets/js/56.9bdcc725.js"><link rel="prefetch" href="/assets/js/57.f9bdc62e.js"><link rel="prefetch" href="/assets/js/58.08a01101.js"><link rel="prefetch" href="/assets/js/59.06504c79.js"><link rel="prefetch" href="/assets/js/6.c9f801d3.js"><link rel="prefetch" href="/assets/js/60.e8d19ca4.js"><link rel="prefetch" href="/assets/js/61.917f455a.js"><link rel="prefetch" href="/assets/js/62.c73d45a6.js"><link rel="prefetch" href="/assets/js/63.4bc66bdf.js"><link rel="prefetch" href="/assets/js/64.75d218e8.js"><link rel="prefetch" href="/assets/js/65.8cc0b8e8.js"><link rel="prefetch" href="/assets/js/66.e13d663c.js"><link rel="prefetch" href="/assets/js/67.e723336f.js"><link rel="prefetch" href="/assets/js/68.111ce9ef.js"><link rel="prefetch" href="/assets/js/69.867bd53e.js"><link rel="prefetch" href="/assets/js/7.2cdf4913.js"><link rel="prefetch" href="/assets/js/70.47e43d77.js"><link rel="prefetch" href="/assets/js/71.6c35c4f0.js"><link rel="prefetch" href="/assets/js/72.8d802072.js"><link rel="prefetch" href="/assets/js/73.abc4a81f.js"><link rel="prefetch" href="/assets/js/74.f325ee75.js"><link rel="prefetch" href="/assets/js/75.3dcc06bb.js"><link rel="prefetch" href="/assets/js/76.551b2aa0.js"><link rel="prefetch" href="/assets/js/77.6475c13f.js"><link rel="prefetch" href="/assets/js/78.d9fcf059.js"><link rel="prefetch" href="/assets/js/79.e5872c32.js"><link rel="prefetch" href="/assets/js/8.45cfcdd8.js"><link rel="prefetch" href="/assets/js/80.2bfdf89b.js"><link rel="prefetch" href="/assets/js/81.9282907f.js"><link rel="prefetch" href="/assets/js/82.d4df8819.js"><link rel="prefetch" href="/assets/js/83.c05bd862.js"><link rel="prefetch" href="/assets/js/84.2c85dd0b.js"><link rel="prefetch" href="/assets/js/85.aeba5015.js"><link rel="prefetch" href="/assets/js/86.100539d5.js"><link rel="prefetch" href="/assets/js/87.ac589916.js"><link rel="prefetch" href="/assets/js/88.45a2ef2f.js"><link rel="prefetch" href="/assets/js/89.45cfa918.js"><link rel="prefetch" href="/assets/js/9.f9c2da80.js"><link rel="prefetch" href="/assets/js/90.9c1a4582.js"><link rel="prefetch" href="/assets/js/91.a9a5ad52.js"><link rel="prefetch" href="/assets/js/92.1256a6c0.js"><link rel="prefetch" href="/assets/js/93.d44d11f6.js"><link rel="prefetch" href="/assets/js/94.d35e12fc.js"><link rel="prefetch" href="/assets/js/95.0795c8ee.js"><link rel="prefetch" href="/assets/js/96.d2461260.js"><link rel="prefetch" href="/assets/js/97.03f0e00f.js"><link rel="prefetch" href="/assets/js/98.d81fed7a.js"><link rel="prefetch" href="/assets/js/99.cfebffd7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8405cd42.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/orangbus.png" alt="OrangBus" class="logo"> <span class="site-name can-hide">OrangBus</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Window" class="dropdown-title"><span class="title">Window</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Window/" class="nav-link">
  高效工具
</a></li><li class="dropdown-item"><!----> <a href="https://pc.qq.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  软件中心
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>
          开发工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.jetbrains.com/toolbox-app/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jetbrains
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://laragon.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  laragon
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.php.net/downloads.php" target="_blank" rel="noopener noreferrer" class="nav-link external">
  php版本安装
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://pecl.php.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  php扩展
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><span class="title">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Linux/Config.html" class="nav-link">
  配置文件
</a></li><li class="dropdown-item"><!----> <a href="/Linux/Tool.html" class="nav-link">
  生产工具
</a></li><li class="dropdown-item"><!----> <a href="/Linux/App.html" class="nav-link">
  应用
</a></li><li class="dropdown-item"><!----> <a href="/Linux/SedAwk.html" class="nav-link">
  SedAwk
</a></li><li class="dropdown-item"><!----> <a href="/Linux/Question.html" class="nav-link">
  问题解答
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/orangbus/tool" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Manjaro入门到生产
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>
          开发环境
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="http://laradock.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Laradock
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.bt.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  宝塔Linux面板
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://laragon.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  laragon-window
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          Linux发行版
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.centos.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  centos
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.deepin.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Deepin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://cn.ubuntu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Ubuntu
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://manjaro.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Manjaro
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          Laradock实战
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://yeasy.gitbooks.io/docker_practice/install/mirror.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docker入门到实战
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://laradock.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Laradock官网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://labs.play-with-docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docker在线学习调试
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://labs.play-with-k8s.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  play with Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Code" class="dropdown-title"><span class="title">Code</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Html
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Code/RequireJs.html" class="nav-link">
  RequireJs
</a></li><li class="dropdown-subitem"><a href="/Code/Layui.html" class="nav-link">
  Layui笔记
</a></li><li class="dropdown-subitem"><a href="/Code/Javascript.html" class="nav-link">
  Javascript手册
</a></li><li class="dropdown-subitem"><a href="/Code/Css.html" class="nav-link">
  Css样式收藏
</a></li><li class="dropdown-subitem"><a href="/Code/Menu.html" class="nav-link">
  在线手册
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Code/VueNote.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><h4>
          Php
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Code/Php.html" class="nav-link">
  Php使用技巧
</a></li><li class="dropdown-subitem"><a href="/Code/Thinkphp.html" class="nav-link">
  ThinkPhp
</a></li><li class="dropdown-subitem"><a href="/Code/LaraCode.html" class="nav-link">
  LaraCode
</a></li></ul></li><li class="dropdown-item"><h4>
          Python
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Python/Python.html" class="nav-link">
  Python入门
</a></li><li class="dropdown-subitem"><a href="/Python/Scrapy.html" class="nav-link">
  Scrapy
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/Docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/Mysql/" class="nav-link">
  Mysql
</a></div><div class="nav-item"><a href="/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/Golang/" class="nav-link">
  Golang
</a></div><div class="nav-item"><a href="/MyNote/" class="nav-link">
  MyNote
</a></div><div class="nav-item"><a href="/WebNote/" class="nav-link router-link-active">
  WebNote
</a></div><div class="nav-item"><a href="/OrangBus/" class="nav-link">
  OrangBus
</a></div> <a href="https://github.com/orangbus/vuepress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Window" class="dropdown-title"><span class="title">Window</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Window/" class="nav-link">
  高效工具
</a></li><li class="dropdown-item"><!----> <a href="https://pc.qq.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  软件中心
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>
          开发工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.jetbrains.com/toolbox-app/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jetbrains
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://laragon.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  laragon
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.php.net/downloads.php" target="_blank" rel="noopener noreferrer" class="nav-link external">
  php版本安装
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://pecl.php.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  php扩展
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><span class="title">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Linux/Config.html" class="nav-link">
  配置文件
</a></li><li class="dropdown-item"><!----> <a href="/Linux/Tool.html" class="nav-link">
  生产工具
</a></li><li class="dropdown-item"><!----> <a href="/Linux/App.html" class="nav-link">
  应用
</a></li><li class="dropdown-item"><!----> <a href="/Linux/SedAwk.html" class="nav-link">
  SedAwk
</a></li><li class="dropdown-item"><!----> <a href="/Linux/Question.html" class="nav-link">
  问题解答
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/orangbus/tool" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Manjaro入门到生产
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>
          开发环境
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="http://laradock.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Laradock
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.bt.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  宝塔Linux面板
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://laragon.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  laragon-window
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          Linux发行版
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.centos.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  centos
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.deepin.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Deepin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://cn.ubuntu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Ubuntu
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://manjaro.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Manjaro
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          Laradock实战
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://yeasy.gitbooks.io/docker_practice/install/mirror.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docker入门到实战
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://laradock.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Laradock官网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://labs.play-with-docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docker在线学习调试
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://labs.play-with-k8s.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  play with Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Code" class="dropdown-title"><span class="title">Code</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Html
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Code/RequireJs.html" class="nav-link">
  RequireJs
</a></li><li class="dropdown-subitem"><a href="/Code/Layui.html" class="nav-link">
  Layui笔记
</a></li><li class="dropdown-subitem"><a href="/Code/Javascript.html" class="nav-link">
  Javascript手册
</a></li><li class="dropdown-subitem"><a href="/Code/Css.html" class="nav-link">
  Css样式收藏
</a></li><li class="dropdown-subitem"><a href="/Code/Menu.html" class="nav-link">
  在线手册
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Code/VueNote.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><h4>
          Php
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Code/Php.html" class="nav-link">
  Php使用技巧
</a></li><li class="dropdown-subitem"><a href="/Code/Thinkphp.html" class="nav-link">
  ThinkPhp
</a></li><li class="dropdown-subitem"><a href="/Code/LaraCode.html" class="nav-link">
  LaraCode
</a></li></ul></li><li class="dropdown-item"><h4>
          Python
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Python/Python.html" class="nav-link">
  Python入门
</a></li><li class="dropdown-subitem"><a href="/Python/Scrapy.html" class="nav-link">
  Scrapy
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/Docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/Mysql/" class="nav-link">
  Mysql
</a></div><div class="nav-item"><a href="/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/Golang/" class="nav-link">
  Golang
</a></div><div class="nav-item"><a href="/MyNote/" class="nav-link">
  MyNote
</a></div><div class="nav-item"><a href="/WebNote/" class="nav-link router-link-active">
  WebNote
</a></div><div class="nav-item"><a href="/OrangBus/" class="nav-link">
  OrangBus
</a></div> <a href="https://github.com/orangbus/vuepress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>WebNote</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/WebNote/BeautifulSoup修改文档树.html" class="sidebar-link">BeautifulSoup修改文档树</a></li><li><a href="/WebNote/Docker Compose 配置文件详解 .html" class="sidebar-link">Docker Compose 配置文件详解</a></li><li><a href="/WebNote/Docker Dockerfile.html" class="sidebar-link">Dockerfile</a></li><li><a href="/WebNote/Docker的镜像制作与整套项目一键打包部署.html" class="sidebar-link">Docker的镜像制作与整套项目一键打包部署</a></li><li><a href="/WebNote/Filebeat模块与配置.html" class="sidebar-link">Filebeat模块与配置</a></li><li><a href="/WebNote/Git webhook 实现自动部署教程.html" class="sidebar-link">Git webhook 实现自动部署教程</a></li><li><a href="/WebNote/Go语言搬砖 操作MeiliSearch.html" class="sidebar-link">/WebNote/Go语言搬砖 操作MeiliSearch.html</a></li><li><a href="/WebNote/Linux命令之Crontab——定时任务.html" class="sidebar-link">Linux命令之Crontab——定时任务</a></li><li><a href="/WebNote/Linux环境下MySQL8.0安装.html" class="sidebar-link">Linux环境下MySQL8.0安装</a></li><li><a href="/WebNote/MySQL性能优化详解.html" class="active sidebar-link">MySQL性能优化详解【精华篇】</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/WebNote/" aria-current="page" class="sidebar-link">十个催泪虐心的小故事</a></li><li><a href="/WebNote/Redis 几种数据类型及应用场景.html" class="sidebar-link">Redis 几种数据类型及应用场景</a></li><li><a href="/WebNote/SH Key 突然失效问题解答及处理办法.html" class="sidebar-link">SSH Key 突然失效问题解答及处理办法</a></li><li><a href="/WebNote/UserAgent.html" class="sidebar-link">UserAgent</a></li><li><a href="/WebNote/Vue-cli -axios 跨域.html" class="sidebar-link">Vue-cli -axios 跨域</a></li><li><a href="/WebNote/Vue-cli 引入各种静态资源.html" class="sidebar-link">Vue-cli 引入各种静态资源</a></li><li><a href="/WebNote/Vuetify.html" class="sidebar-link">Vuetify – 色彩，主题与基础样式</a></li><li><a href="/WebNote/docker-compose 搭建 minio 分布式对象存储 最新版(使用教程).html" class="sidebar-link">docker-compose 搭建 minio 分布式对象存储</a></li><li><a href="/WebNote/docker安装Syncthing，并配置数据同步备份.html" class="sidebar-link">docker安装Syncthing备份数据</a></li><li><a href="/WebNote/mysql order by 原理及优化详解.html" class="sidebar-link">mysql order by 原理及优化详解</a></li><li><a href="/WebNote/nginx 黑名单和白名单.html" class="sidebar-link">nginx 黑名单和白名单</a></li><li><a href="/WebNote/php 生成随机数 生成随机字符串的 5 种方法.html" class="sidebar-link">php 生成随机数 生成随机字符串的 5 种方法</a></li><li><a href="/WebNote/php中call_user_func 与 call_user_func_array的使用 .html" class="sidebar-link">php-calluserfunc使用</a></li><li><a href="/WebNote/x-ui面板+宝塔+伪装网站+CDN节点.html" class="sidebar-link">/WebNote/x-ui面板+宝塔+伪装网站+CDN节点.html</a></li><li><a href="/WebNote/一篇文章教你顺利入门和开发 chrome 扩展程序.html" class="sidebar-link">一篇文章教你顺利入门和开发 chrome 扩展程序</a></li><li><a href="/WebNote/使用Certbot自动配置LetsEncrypt证书.html" class="sidebar-link">使用Certbot自动配置LetsEncrypt证书</a></li><li><a href="/WebNote/关于 Laravel项目多进程队列配置的使用.html" class="sidebar-link">/WebNote/关于 Laravel项目多进程队列配置的使用.html</a></li><li><a href="/WebNote/切换国内源及讯飞输入法安装.html" class="sidebar-link">切换国内源及讯飞输入法安装</a></li><li><a href="/WebNote/刻意练习 Elasticsearch 10000 个小时，鬼知道经历了什么？.html" class="sidebar-link">/WebNote/刻意练习 Elasticsearch 10000 个小时，鬼知道经历了什么？.html</a></li><li><a href="/WebNote/向 GitHub 提交代码时触发 Jenkins 自动构建.html" class="sidebar-link">向 GitHub 提交代码时触发 Jenkins 自动构建</a></li><li><a href="/WebNote/如何在局域网用一台服务器配置多站点？.html" class="sidebar-link">如何在局域网用一台服务器配置多站点？</a></li><li><a href="/WebNote/如何快速清理 docker 资源.html" class="sidebar-link">如何快速清理 docker 资源</a></li><li><a href="/WebNote/如何解决Docker 搭建pxc集群后，节点宕机，启动闪退.html" class="sidebar-link">pxc宕机重启场景还原及正确的启动方式</a></li><li><a href="/WebNote/打包压缩命令.html" class="sidebar-link">linux常用打包压缩格式</a></li><li><a href="/WebNote/课程脚本.html" class="sidebar-link">《Docker环境下的前后端分离部署与运维》课程脚本</a></li><li><a href="/WebNote/面试，看这一篇就够了.html" class="sidebar-link">mysql优化建议</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>本文由 <a href="http://ksria.com/simpread/" target="_blank" rel="noopener noreferrer">简悦 SimpRead<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 转码， 原文地址 <a href="https://blog.csdn.net/weixin_42948935/article/details/119609230?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">blog.csdn.net<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <ol start="0"><li>前置说明</li></ol> <hr> <ul><li><p>本文使用的数据库存储200万行的记录</p></li> <li><p>全文词数：6169</p></li> <li><p>sql文件下载地址：https://gitee.com/alizipeng/the-way-of-programming/blob/master/09-%E6%95%B0%E6%8D%AE%E5%BA%93/user.sql</p></li> <li><p>若希望看到其他技术笔记欢迎来访我的技术笔记项目：https://gitee.com/alizipeng/the-way-of-programming</p> <div class="language- extra-class"><pre class="language-text"><code>`mysql&gt; select count(*) from user;
+----------+
| count(*) |
+----------+
|  2000000 |
+----------+
1 row in set (0.14 sec)

mysql&gt; select * from user limit 10;
+----+----------------------+------+-----------+---------------------+
| id | name                 | age  | address   | birthday            |
+----+----------------------+------+-----------+---------------------+
|  1 | Z7zEgyrL3PJq86sfhas3 |   26 | 云浮市    | 2019-01-13 10:04:55 |
|  2 | MrldItwPeb6VDk7zCOO1 |    2 | 汕尾市    | 2018-10-18 09:41:51 |
|  3 | 5ag8vXuMnV0JRBH2PKkG |   72 | 梅州市    | 2021-06-16 06:22:28 |
|  4 | SccWwgENpikMyriAdJ3V |   12 | 江门市    | 2019-01-17 15:21:14 |
|  5 | 96jgKGorO4IQAFg6kIKN |   63 | 深圳市    | 2020-02-25 14:35:45 |
|  6 | l8ZJtMI90mfHGTSMcZGm |   15 | 珠海市    | 2019-07-05 12:25:37 |
|  7 | ZUu15AfviMv64bI9JGVk |   21 | 东莞      | 2018-12-04 17:18:22 |
|  8 | CVXyTqfPgOVPrq2UDPol |   37 | 梅州市    | 2021-03-24 11:51:06 |
|  9 | 2sLdyXj6ihbQ2eXUc8n0 |   35 | 河源市    | 2020-11-16 16:39:59 |
| 10 | pyM43aO6C24upRSDSMYr |   37 | 湛江市    | 2020-07-27 22:11:45 |
+----+----------------------+------+-----------+---------------------+
10 rows in set (0.00 sec)` ![][img-0]

*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11
*   12
*   13
*   14
*   15
*   16
*   17
*   18
*   19
*   20
*   21
*   22
*   23
*   24


</code></pre></div></li></ul> <ol><li>索引优化</li></ol> <hr> <p>索引是优化查询最有效的方式之一</p> <h3 id="_1-1-是否使用索引的区别"><a href="#_1-1-是否使用索引的区别" class="header-anchor">#</a> 1.1 是否使用索引的区别</h3> <p><img src="https://img-blog.csdnimg.cn/6f170a01587841b4a69a2fcdaa38d06d.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-mnp2PneK-1628668796487)(resource/1628664942206.png)]"></p> <ul><li>不使用索引</li></ul> <div class="language- extra-class"><pre class="language-text"><code>`mysql&gt; select * from user where name = 'Z7zEgyrL3PJq86sfhas3';
+----+----------------------+------+-----------+---------------------+
| id | name                 | age  | address   | birthday            |
+----+----------------------+------+-----------+---------------------+
|  1 | Z7zEgyrL3PJq86sfhas3 |   26 | 云浮市    | 2019-01-13 10:04:55 |
+----+----------------------+------+-----------+---------------------+
1 row in set (0.55 sec)` 

*   1
*   2
*   3
*   4
*   5
*   6
*   7


</code></pre></div><ul><li>使用索引</li></ul> <div class="language- extra-class"><pre class="language-text"><code>`mysql&gt; create index idx_user_name on user(name);
Query OK, 0 rows affected (20.66 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; select * from user where name = 'Z7zEgyrL3PJq86sfhas3';
+----+----------------------+------+-----------+---------------------+
| id | name                 | age  | address   | birthday            |
+----+----------------------+------+-----------+---------------------+
|  1 | Z7zEgyrL3PJq86sfhas3 |   26 | 云浮市    | 2019-01-13 10:04:55 |
+----+----------------------+------+-----------+---------------------+
1 row in set (0.00 sec)` 

*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11


</code></pre></div><h3 id="_1-2-索引的使用"><a href="#_1-2-索引的使用" class="header-anchor">#</a> 1.2 索引的使用</h3> <h4 id="_1-2-1-避免索引失效"><a href="#_1-2-1-避免索引失效" class="header-anchor">#</a> 1.2.1 避免索引失效</h4> <h5 id="_1-2-1-1-建立复合索引"><a href="#_1-2-1-1-建立复合索引" class="header-anchor">#</a> 1.2.1.1 建立复合索引</h5> <div class="language- extra-class"><pre class="language-text"><code>`mysql&gt; create index idx_user_name_age_address on user(name, age, address);
Query OK, 0 rows affected (29.46 sec)
Records: 0  Duplicates: 0  Warnings: 0` 

*   1
*   2
*   3


</code></pre></div><h5 id="_1-2-1-2-全值匹配"><a href="#_1-2-1-2-全值匹配" class="header-anchor">#</a> 1.2.1.2 全值匹配</h5> <p>对索引中所有列都指定具体值，索引生效</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from user where name='Z7zEgyrL3PJq86sfhas3' and age = 26 and address='云浮市';` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/cb94f93e5c2348e3bd52336be5a63e0f.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-7z0uq5N1-1628668796499)(resource/1628665638188.png)]"></p> <h5 id="_1-2-1-3-最左前缀法则"><a href="#_1-2-1-3-最左前缀法则" class="header-anchor">#</a> 1.2.1.3 最左前缀法则</h5> <p>如果索引多列，需要遵循最左前缀法则。指查询从索引的最左列顺序开始，不能跳过中间的列</p> <p>索引生效的情况：</p> <p><img src="https://img-blog.csdnimg.cn/5ad6b3986eba4b97bc9e98b3d0d43412.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-9vRoiA21-1628668796503)(resource/1628665874239.png)]"></p> <p>索引失效的情况：</p> <p><img src="https://img-blog.csdnimg.cn/da4dbae94b4a4dcf84ade2df128ab9c2.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-TQ8HerYV-1628668796510)(resource/1628666082131.png)]"></p> <h5 id="_1-2-1-4-范围查询"><a href="#_1-2-1-4-范围查询" class="header-anchor">#</a> 1.2.1.4 范围查询</h5> <p>范围查询右边的列不能使用索引</p> <p><img src="https://img-blog.csdnimg.cn/e42080bd62e7488997f4c72c952251b8.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-mOIIahS1-1628668796515)(resource/1628666287071.png)]"></p> <h5 id="_1-2-1-5-运算操作"><a href="#_1-2-1-5-运算操作" class="header-anchor">#</a> 1.2.1.5 运算操作</h5> <p>在索引列上使用运算操作，索引失效</p> <p><img src="https://img-blog.csdnimg.cn/99d47f1ece264f25bc73774328705f4e.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-DhFdLjWb-1628668796520)(resource/1628666470559.png)]"></p> <h5 id="_1-2-1-6-字符串字段"><a href="#_1-2-1-6-字符串字段" class="header-anchor">#</a> 1.2.1.6 字符串字段</h5> <p>不加单引号，索引失效【该执行结果使用的是另外的表】</p> <p><img src="https://img-blog.csdnimg.cn/d58bc9e89d96440ea9bb418cc461accd.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-QREtMnCK-1628668796527)(resource/1628666562405.png)]"></p> <h5 id="_1-2-1-7-覆盖索引"><a href="#_1-2-1-7-覆盖索引" class="header-anchor">#</a> 1.2.1.7 覆盖索引</h5> <p>尽量使用覆盖索引【索引包含查询列】，减少使用<code>select *</code></p> <div class="language- extra-class"><pre class="language-text"><code>`Extra字段：
	using index：使用覆盖索引
	using where：使用索引，但需要回表查询
	using index condition：使用索引，但需要回表查询
	using index; using where：使用索引，需要的字段都在索引中找到，不需要回表查询` 

*   1
*   2
*   3
*   4
*   5


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/e63f46a7606e419e82f0376474834789.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-bMxZoity-1628668796532)(resource/1628667048794.png)]"></p> <h5 id="_1-2-1-8-or条件查询"><a href="#_1-2-1-8-or条件查询" class="header-anchor">#</a> 1.2.1.8 OR条件查询</h5> <p>若 or 前的条件有索引，后面的列没有索引，则索引全部失效</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from user where name = 'Z7zEgyrL3PJq86sfhas3' or birthday='2019-01-13 10:04:55';` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/a7c92220491d480ea5459a21749d24c3.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-I501Mbzo-1628668796536)(resource/1628667255843.png)]"></p> <h5 id="_1-2-1-9-like模糊查询"><a href="#_1-2-1-9-like模糊查询" class="header-anchor">#</a> 1.2.1.9 Like模糊查询</h5> <p>以<code>%</code>开头的Like模糊查询，索引失效</p> <p><img src="https://img-blog.csdnimg.cn/636568dd4851456b96fe639819bab8cf.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Hu7eDtwF-1628668796540)(resource/1628667406879.png)]"></p> <p>但可以通过覆盖索引解决</p> <p><img src="https://img-blog.csdnimg.cn/8101d9f50d7641d981b8e6bf60fac562.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-lDE4h4rT-1628668796543)(resource/1628667492973.png)]"></p> <h5 id="_1-2-1-10-全表扫描"><a href="#_1-2-1-10-全表扫描" class="header-anchor">#</a> 1.2.1.10 全表扫描</h5> <p>若MySQL判定全表扫描将比使用索引更快，则不使用索引</p> <h5 id="_1-2-1-11-is-not-null"><a href="#_1-2-1-11-is-not-null" class="header-anchor">#</a> 1.2.1.11 is [not] null</h5> <p>有时索引失效【根据该字段为null的比例判断】</p> <p><img src="https://img-blog.csdnimg.cn/620ffeefe67040ab815749ffcaa492f5.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-dl8p4fUl-1628668796546)(resource/1628667752772.png)]"></p> <h5 id="_1-2-1-12-not-in"><a href="#_1-2-1-12-not-in" class="header-anchor">#</a> 1.2.1.12 [not] in</h5> <p>// todo</p> <h5 id="_1-2-1-13-单列索引和复合索引"><a href="#_1-2-1-13-单列索引和复合索引" class="header-anchor">#</a> 1.2.1.13 单列索引和复合索引</h5> <p>尽量使用复合索引，少使用单列索引</p> <p><img src="https://img-blog.csdnimg.cn/f66c6ad1e7574957be77fc223fe954fa.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-wbjUissq-1628668796548)(resource/1628668093875.png)]"></p> <p>复合索引<code>idx_user_name_age_address</code>相当于创建了三个索引：</p> <p><code>name</code></p> <p><code>name + age</code></p> <p><code>name + age + address</code></p> <p>当创建多个单列索引时，数据库会选择一个最优的索引【辨识度最高】，并不会使用全部索引</p> <h4 id="_1-2-2-查看索引使用情况"><a href="#_1-2-2-查看索引使用情况" class="header-anchor">#</a> 1.2.2 查看索引使用情况</h4> <div class="language- extra-class"><pre class="language-text"><code>`show [session|global]status like 'Handler_read%';` 

*   1


</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>`mysql&gt; show global status like 'Handler_read%';
+-----------------------+----------+
| Variable_name         | Value    |
+-----------------------+----------+
| Handler_read_first    | 194      |
| Handler_read_key      | 6004303  |
| Handler_read_last     | 0        |
| Handler_read_next     | 6007205  |
| Handler_read_prev     | 0        |
| Handler_read_rnd      | 330      |
| Handler_read_rnd_next | 33054118 |
+-----------------------+----------+
7 rows in set (0.00 sec)

mysql&gt; show status like 'Handler_read%';
+-----------------------+-------+
| Variable_name         | Value |
+-----------------------+-------+
| Handler_read_first    | 1     |
| Handler_read_key      | 17    |
| Handler_read_last     | 0     |
| Handler_read_next     | 16    |
| Handler_read_prev     | 0     |
| Handler_read_rnd      | 4     |
| Handler_read_rnd_next | 5     |
+-----------------------+-------+
7 rows in set (0.01 sec)` ![][img-1]

*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11
*   12
*   13
*   14
*   15
*   16
*   17
*   18
*   19
*   20
*   21
*   22
*   23
*   24
*   25
*   26
*   27


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/e6f11404d3e64f24989469f9737dbd4b.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="1"></p> <ol start="2"><li><a href="https://so.csdn.net/so/search?q=SQL%E4%BC%98%E5%8C%96&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">SQL优化<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <hr> <h3 id="_2-1-优化步骤"><a href="#_2-1-优化步骤" class="header-anchor">#</a> 2.1 优化步骤</h3> <h4 id="_2-1-1查看sql执行频率"><a href="#_2-1-1查看sql执行频率" class="header-anchor">#</a> 2.1.1查看SQL执行频率</h4> <blockquote><ul><li>show status可以查看数据库的状态信息</li> <li><code>session级别</code>显示当前会话的状态信息【默认】</li> <li><code>global级别</code>显示自数据库上次启动至今的状态信息</li></ul></blockquote> <h5 id="_2-1-1-1-查看整个数据库crud执行频次"><a href="#_2-1-1-1-查看整个数据库crud执行频次" class="header-anchor">#</a> 2.1.1.1 查看整个数据库CRUD执行频次</h5> <div class="language- extra-class"><pre class="language-text"><code>`-- 显示增删改查频次，确定数据库是以修改为主还是插入为主
show [session|global] status like 'Com_______';` 

*   1
*   2


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/0b840ad6e0e54da1ab180e079c227c87.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h5 id="_2-1-1-1-查看innodb存储引擎执行频次"><a href="#_2-1-1-1-查看innodb存储引擎执行频次" class="header-anchor">#</a> 2.1.1.1 查看Innodb存储引擎执行频次</h5> <div class="language- extra-class"><pre class="language-text"><code>`-- 查看innodb存储引擎的CRUD执行频次
show global status like 'innodb_rows_%';` 

*   1
*   2


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/72683b6b3e1f4311a91cb98a229bff17.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-y3jSVZ7A-1628668796558)(resource/1628555264600.png)]"></p> <h4 id="_2-1-2-定位低效率sql"><a href="#_2-1-2-定位低效率sql" class="header-anchor">#</a> 2.1.2 定位低效率SQL</h4> <h5 id="_2-1-2-1-慢查询日志定位"><a href="#_2-1-2-1-慢查询日志定位" class="header-anchor">#</a> 2.1.2.1 慢查询日志定位</h5> <blockquote><ul><li><p>慢查询日志记录了索引执行时间超过<code>long_query_time</code>并且</p> <p>扫描记录数<code>&gt;=</code> <code>min_examined_row_limit</code>的所有SQL语句的日志</p></li> <li><p><code>long_query_time</code>默认10秒，最小为0，可以精确到微秒</p></li></ul></blockquote> <h6 id="_2-1-2-1-1-文件位置和格式"><a href="#_2-1-2-1-1-文件位置和格式" class="header-anchor">#</a> 2.1.2.1.1 文件位置和格式</h6> <div class="language- extra-class"><pre class="language-text"><code>`# 开启慢查询
slow_query_log=1
# 指定慢查询日志文件名
slow_query_log_file=slow_query.log
# 超时阈值
long_query_time=10` 

*   1
*   2
*   3
*   4
*   5
*   6


</code></pre></div><h6 id="_2-1-2-1-2-日志读取"><a href="#_2-1-2-1-2-日志读取" class="header-anchor">#</a> 2.1.2.1.2 日志读取</h6> <blockquote><ul><li><p>查询long_query_time值</p> <div class="language- extra-class"><pre class="language-text"><code>`mysql&gt; show variables like 'long_query_time';
+-----------------+----------+
| Variable_name   | Value    |
+-----------------+----------+
| long_query_time | 1.000000 |
+-----------------+----------+
1 row in set (0.01 sec)` 
    
*   1
*   2
*   3
*   4
*   5
*   6
*   7


</code></pre></div></li> <li><p>执行一次慢查询，查看日志</p> <div class="language- extra-class"><pre class="language-text"><code>`mysql&gt; select * from user where name like '%Zjcfpe%';
Empty set (1.02 sec)` 
    
*   1
*   2


</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>`[root@VM-0-6-centos ~]# tail -f /www/server/data/mysql-slow.log
/www/server/mysql/bin/mysqld, Version: 8.0.24 (Source distribution). started with:
Tcp port: 3306  Unix socket: /tmp/mysql.sock
Time                 Id Command    Argument
# Time: 2021-08-10T06:35:58.334350Z
# User@Host: root[root] @ localhost []  Id:     8
# Query_time: 1.016230  Lock_time: 0.000104 Rows_sent: 0  Rows_examined: 2000000
use myroot;
SET timestamp=1628577357;
select * from user where name like '%Zjcfpe%';` 
    
*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11


</code></pre></div></li> <li><p>读取慢查询文件</p> <div class="language- extra-class"><pre class="language-text"><code>`[root@VM-0-6-centos ~]# cat /www/server/data/mysql-slow.log
/www/server/mysql/bin/mysqld, Version: 8.0.24 (Source distribution). started with:
Tcp port: 3306  Unix socket: /tmp/mysql.sock
Time                 Id Command    Argument
# Time: 2021-08-10T03:27:52.943049Z
# User@Host: myroot[myroot] @  [120.239.131.249]  Id:     8
# Query_time: 4.329975  Lock_time: 0.000125 Rows_sent: 27751  Rows_examined: 2000000
use myroot;
SET timestamp=1628566068;
select * from user where name like '%j5%';
/www/server/mysql/bin/mysqld, Version: 8.0.24 (Source distribution). started with:
Tcp port: 3306  Unix socket: /tmp/mysql.sock
Time                 Id Command    Argument
# Time: 2021-08-10T06:35:58.334350Z
# User@Host: root[root] @ localhost []  Id:     8
# Query_time: 1.016230  Lock_time: 0.000104 Rows_sent: 0  Rows_examined: 2000000
use myroot;
SET timestamp=1628577357;
select * from user where name like '%Zjcfpe%';` ![][img-2]
    
*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11
*   12
*   13
*   14
*   15
*   16
*   17
*   18
*   19


</code></pre></div></li></ul></blockquote> <h6 id="_2-1-2-1-3使用mysqldumpslow工具读取"><a href="#_2-1-2-1-3使用mysqldumpslow工具读取" class="header-anchor">#</a> 2.1.2.1.3使用mysqldumpslow工具读取</h6> <div class="language- extra-class"><pre class="language-text"><code>`## 建立软连接
[root@VM-0-6-centos bin]# ln -s /www/server/mysql/bin/mysqldumpslow /usr/bin
[root@VM-0-6-centos bin]# mysqldumpslow /www/server/data/mysql-slow.log

Reading mysql slow query log from /www/server/data/mysql-slow.log
Count: 2  Time=2.67s (5s)  Lock=0.00s (0s)  Rows=13875.5 (27751), 2users@2hosts
  select * from user where name like 'S'` 

*   1
*   2
*   3
*   4
*   5
*   6
*   7


</code></pre></div><h5 id="_2-1-2-2-show-processlist定位"><a href="#_2-1-2-2-show-processlist定位" class="header-anchor">#</a> 2.1.2.2 show processlist定位</h5> <blockquote><ul><li><code>适用于实时查看SQL执行情况、线程状态、是否锁表等</code></li></ul></blockquote> <p><img src="https://img-blog.csdnimg.cn/e95e02542fee49b4b3bc8b87e756a9d6.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-huff06gN-1628668796560)(resource/1628578720341.png)]"></p> <table><thead><tr><th>列名</th><th>描述</th></tr></thead><tbody><tr><td>id列</td><td>用户登录mysql时，系统分配的<code>connection_id</code>，可以使用函数connection_id()查看</td></tr><tr><td>user列</td><td>显示当前用户。如果不是root用户，这个命令只显示用户权限范围内的sql记录</td></tr><tr><td>host列</td><td>显示这个SQL语句是从哪个IP+端口发来的</td></tr><tr><td>db列</td><td>操作的目标数据库</td></tr><tr><td>command列</td><td>当前连接的执行命令，休眠【sleep】查询【query】连接【connect】</td></tr><tr><td>time列</td><td>当前状态的持续时间，秒</td></tr><tr><td>status列</td><td>当前连接的SQL语句的执行状态如<code>executing</code> <code>sending data</code>等</td></tr><tr><td>Info列</td><td>执行的SQL语句</td></tr></tbody></table> <blockquote><ul><li><p>执行一次慢查询</p> <p><img src="https://img-blog.csdnimg.cn/6ebe515c5ee2443a9a57524e6b25cbb3.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-aZK78PV4-1628668796562)(resource/1628579511132.png)]"></p></li></ul></blockquote> <blockquote><ul><li><p>同时查看实时情况</p> <p><img src="https://img-blog.csdnimg.cn/c8429a70d7a54067a84be0e43da9d492.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-KvfpG6de-1628668796564)(resource/1628579550205.png)]"></p></li></ul></blockquote> <h4 id="_2-1-3-explain分析sql"><a href="#_2-1-3-explain分析sql" class="header-anchor">#</a> 2.1.3 explain分析SQL</h4> <blockquote><ul><li>当定位到效率低的SQL语句后，可以通过<code>explain</code>获取SQL的执行计划</li></ul></blockquote> <h5 id="_2-1-3-1-查看执行计划"><a href="#_2-1-3-1-查看执行计划" class="header-anchor">#</a> 2.1.3.1 查看执行计划</h5> <div class="language- extra-class"><pre class="language-text"><code>`expalin select * from user where id = 1000;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/697cadaf41864074a7b695468ae28a53.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-IW4AFti1-1628668796566)(resource/1628579918021.png)]"></p> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from user where name = 'KBmXzR6PoIv6T5NQQ27w';` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/86c41d1a3f944d17917dd398bb05957a.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-KP5owVwO-1628668796568)(resource/1628579989186.png)]"></p> <h5 id="_2-1-3-2-各字段含义"><a href="#_2-1-3-2-各字段含义" class="header-anchor">#</a> 2.1.3.2 各字段含义</h5> <table><thead><tr><th>字段</th><th>含义</th></tr></thead><tbody><tr><td>id</td><td>select查询的序列号，标识查询中执行select子句或者是操作表的顺序</td></tr><tr><td>select_type</td><td>Select的类型，常见取值：SIMPLE【简单表，不关联表或子查询】PRIMARY【主查询，外层的查询】UNION【UNION中第二个或后面的查询语句】SUBQUERY【子查询中第一个Select】</td></tr><tr><td>table</td><td>输出结果集的表</td></tr><tr><td>type</td><td>表连接类型，性能由好到坏【system-&gt;const-&gt;eq_ref-&gt;ref-&gt;ref_or_null-&gt;index_merge-&gt;index_subquery-&gt;range-&gt;index-&gt;all】</td></tr><tr><td>possible_keys</td><td>查询时可能使用到的索引</td></tr><tr><td>key</td><td>实际使用到的索引</td></tr><tr><td>key_len</td><td>索引字段长度</td></tr><tr><td>rows</td><td>扫描的行数量</td></tr><tr><td>extra</td><td>执行情况的说明和描述</td></tr></tbody></table> <h5 id="_2-1-3-3-explain之id"><a href="#_2-1-3-3-explain之id" class="header-anchor">#</a> 2.1.3.3 explain之id</h5> <blockquote><ul><li>id相同时，表示加载表的顺序是从上到下</li></ul> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from sys_role r, sys_user u, sys_user_role ur where r.id = ur.id and u.id = ur.id;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/1f3458ee9bd74b408716c1e4a17019c6.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-bSXVNvhy-1628668796570)(resource/1628580803599.png)]"></p></blockquote> <blockquote><ul><li>id不同，id值越大则优先级越高则越先被执行</li></ul> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from sys_role where id = (select role_id from sys_user_role where user_id = (select id from sys_user where username='test'));` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/3dd84e024e3d4650b9ee1230b9064d56.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-FeGabiEr-1628668796572)(resource/1628581151750.png)]"></p></blockquote> <blockquote><ul><li>相同id与不同id同时存在。相同id则可以归为一组，从上往下执行；在所有组中，id值越高，优先级则越大，则越先被执行</li></ul> <p><img src="https://img-blog.csdnimg.cn/afd08b428b4544ef855f6f9831d3ce34.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-CK78he9R-1628668796574)(resource/1628581740579.png)]"></p></blockquote> <h5 id="_2-1-3-4-explain之select-type"><a href="#_2-1-3-4-explain之select-type" class="header-anchor">#</a> 2.1.3.4 explain之select_type</h5> <p>常见取值</p> <table><thead><tr><th>select_type</th><th>含义</th></tr></thead><tbody><tr><td>SIMPLE</td><td>简单的select查询，查询中不包含子查询或UNION</td></tr><tr><td>PRIMARY</td><td>查询中若包含任何复制子查询，则最外层标记为PRIMARY</td></tr><tr><td>SUBQUERY</td><td>在Select或where子句中包含子查询</td></tr><tr><td>DERIVED</td><td>在FROM子句中包含的子查询，MySQL递归执行这些子查询，把结果放入临时表</td></tr><tr><td>UNION</td><td>若第二个SELECT出现在UNION之后，则标记为UNION；<br>若UNION包含在FROM子句的子查询中，外层Select将被标记为DERIVED</td></tr><tr><td>UNION RESULT</td><td>从UNION表获取结果的SELECT</td></tr></tbody></table> <p>SIMPLE例子</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from user;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/b78208ce969f43b28f6358d64102d453.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Kx1ftyhZ-1628668796575)(resource/1628600781169.png)]"></p> <p>PRIMARY &amp; SUBQUERY例子</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from sys_user where id = (select user_id from sys_user_role where id = 1);` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/785153314e4e450faba1eaa6c5e242bb.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-TTebeke2-1628668796577)(resource/1628600829263.png)]"></p> <p>DERIVED例子</p> <p><img src="https://img-blog.csdnimg.cn/62981ec2fb194536ac7ba1c34525b6f7.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-pjIifU7U-1628668796579)(resource/1628601331935.png)]"></p> <p>UNION &amp; UNION RESULT 例子</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select id from sys_user union select id from sys_role;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/3dd677177ede450d81cb5bd0127bed09.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-6uXW4FBY-1628668796580)(resource/1628601469854.png)]"></p> <h5 id="_2-1-3-5-explain之type"><a href="#_2-1-3-5-explain之type" class="header-anchor">#</a> 2.1.3.5 explain之type</h5> <table><thead><tr><th>type</th><th>含义</th></tr></thead><tbody><tr><td>NULL</td><td>不访问任何表、索引，直接返回结果</td></tr><tr><td>system</td><td>表只有一行记录【系统表】</td></tr><tr><td>const</td><td>通过主键索引或者唯一索引，查找出一条记录</td></tr><tr><td>eq_ref</td><td>多表联查，关联的字段都是各自表的主键</td></tr><tr><td>ref</td><td>单表查询：使用唯一索引的前缀索引或非唯一索引的前缀索引或非唯一索引的全列索引进行查询。多表联合查询：关联的字段不是自己表的主键，是外键。</td></tr><tr><td>range</td><td>使用一个单列索引，或复合索引的前缀索引进行范围查询</td></tr><tr><td>index</td><td>从索引树进行查询</td></tr><tr><td>all</td><td>全表扫描</td></tr></tbody></table> <p>NULL例子</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select now();` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/f24325b6ca87481c98a86998955fdba0.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-uZCJHEcw-1628668796582)(resource/1628602303396.png)]"></p> <p>const例子</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from sys_user where id=50;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/643c2c01209548e88be4ac8161e9c09d.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-P3906PFH-1628668796584)(resource/1628602416735.png)]"></p> <p>eq_ref例子</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from sys_user u, sys_role r where u.id=r.id;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/7855ca66bc1340d58c9a3bbc521cbf88.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-MKUkEc58-1628668796586)(resource/1628602951372.png)]"></p> <p>ref例子</p> <div class="language- extra-class"><pre class="language-text"><code>`create index idx_user_login_name on sys_user(login_name);
explain select * from sys_user where login_name = '机构管理员';` 

*   1
*   2


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/11f66b8b497345c5b4d3b0d97dc0b1f8.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-UuS4Hj9p-1628668796588)(resource/1628603248700.png)]"></p> <p>range例子</p> <div class="language- extra-class"><pre class="language-text"><code> `explain select * from sys_user where id in (50,51,52);` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/6ecbb06293f348e7a105d680411441d9.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-i5MbeVb1-1628668796589)(resource/1628603341818.png)]"></p> <p>index例子</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select id from sys_user;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/b2edb2d0127445d2b8f5b5029d2d9274.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ZPTfxNes-1628668796592)(resource/1628603450923.png)]"></p> <p>执行效率排序</p> <div class="language- extra-class"><pre class="language-text"><code>`NULL &gt; system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; all` 

*   1


</code></pre></div><h5 id="_2-1-3-6-explain之key"><a href="#_2-1-3-6-explain之key" class="header-anchor">#</a> 2.1.3.6 explain之key</h5> <div class="language- extra-class"><pre class="language-text"><code>`possible_keys：可能用到的索引列表
key：实际使用的索引
key_len：索引字段的最大可能长度，并非实际使用长度【字节】` 

*   1
*   2
*   3


</code></pre></div><h5 id="_2-1-3-7-explain之extra"><a href="#_2-1-3-7-explain之extra" class="header-anchor">#</a> 2.1.3.7 explain之extra</h5> <p>额外信息</p> <table><thead><tr><th>extra</th><th>含义</th></tr></thead><tbody><tr><td>using filesort</td><td>MySQL对数据使用一个外部的索引排序而不是按照表内的索引顺序进行读取，称为“文件排序”</td></tr><tr><td>using temporary</td><td>使用临时表保存中间结果，MySQL在对查询结果排序时使用临时表。常见于order by group by</td></tr><tr><td>using index</td><td>相应的SELECT操作使用了覆盖索引，避免回表</td></tr></tbody></table> <p>using filesort例子</p> <div class="language- extra-class"><pre class="language-text"><code> `explain select * from sys_user order by password;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/d732aa18b787461b9fc576611f2d30a1.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ZfrTNNEM-1628668796594)(resource/1628604033980.png)]"></p> <p>using temporary例子</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select * from sys_user group by password;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/2c0d1bd9725640d68babd4434284b279.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-GRsfoL8V-1628668796596)(resource/1628604201078.png)]"></p> <p>using index例子</p> <div class="language- extra-class"><pre class="language-text"><code>`explain select username from sys_user order by username;` 

*   1


</code></pre></div><p><img src="https://img-blog.csdnimg.cn/c68df76164244112928fe68109d7de1f.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Z5K3DguB-1628668796600)(resource/1628604164025.png)]"></p> <h4 id="_2-1-4-show-profile分析sql"><a href="#_2-1-4-show-profile分析sql" class="header-anchor">#</a> 2.1.4 show profile分析SQL</h4> <p>show profiles能够在优化SQL中帮助我们了解时间都耗费到哪里了</p> <div class="language- extra-class"><pre class="language-text"><code>`-- 查看当前MySQL是否支持profile
mysql&gt; select @@have_profiling;
+------------------+
| @@have_profiling |
+------------------+
| YES              |
+------------------+
1 row in set, 1 warning (0.00 sec)
-- 查看当前是否开启了profiling
mysql&gt; select @@profiling;
+-------------+
| @@profiling |
+-------------+
|           0 |
+-------------+
1 row in set, 1 warning (0.00 sec)
-- 开启profiling【仅当前session】
mysql&gt; set profiling=1;
Query OK, 0 rows affected, 1 warning (0.00 sec)
-- 进行查询操作
mysql&gt; select * from user limit 20000,1
    -&gt; ;
+-------+----------------------+------+---------+---------------------+
| id    | name                 | age  | address | birthday            |
+-------+----------------------+------+---------+---------------------+
| 20001 | v4Ep2zqXuVJnkIzlRhX9 |   75 | 广州    | 2020-09-30 12:14:05 |
+-------+----------------------+------+---------+---------------------+
1 row in set (0.01 sec)

mysql&gt; select * from user order by name limit 2000,1;
+--------+--------------------------------+------+-----------+---------------------+
| id     | name                           | age  | address   | birthday            |
+--------+--------------------------------+------+-----------+---------------------+
| 764557 | 03uH675cuPcinUmWna2xjQAFP2zxYF |   29 | 珠海市    | 2020-09-12 02:49:11 |
+--------+--------------------------------+------+-----------+---------------------+
1 row in set (6.70 sec)
-- 使用show profiles
mysql&gt; show profiles;
+----------+------------+-----------------------------------------------+
| Query_ID | Duration   | Query                                         |
+----------+------------+-----------------------------------------------+
|        1 | 0.00015600 | SELECT DATABASE()                             |
|        2 | 0.00548875 | select * from user limit 20000,1              |
|        3 | 6.69228925 | select * from user order by name limit 2000,1 |
+----------+------------+-----------------------------------------------+
3 rows in set, 1 warning (0.00 sec)

-- 选择指定记录查看耗时
mysql&gt; show profile for query 3;
+--------------------------------+----------+
| Status                         | Duration |
+--------------------------------+----------+
| starting                       | 0.000082 |
| Executing hook on transaction  | 0.000005 |
| starting                       | 0.000009 |
| checking permissions           | 0.000007 |
| Opening tables                 | 0.000034 |
| init                           | 0.000006 |
| System lock                    | 0.000010 |
| optimizing                     | 0.000005 |
| statistics                     | 0.000016 |
| preparing                      | 0.000022 |
| executing                      | 6.691968 |
| end                            | 0.000018 |
| query end                      | 0.000005 |
| waiting for handler commit     | 0.000023 |
| closing tables                 | 0.000013 |
| freeing items                  | 0.000021 |
| logging slow query             | 0.000033 |
| cleaning up                    | 0.000015 |
+--------------------------------+----------+
18 rows in set, 1 warning (0.03 sec)` ![][img-3]

*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11
*   12
*   13
*   14
*   15
*   16
*   17
*   18
*   19
*   20
*   21
*   22
*   23
*   24
*   25
*   26
*   27
*   28
*   29
*   30
*   31
*   32
*   33
*   34
*   35
*   36
*   37
*   38
*   39
*   40
*   41
*   42
*   43
*   44
*   45
*   46
*   47
*   48
*   49
*   50
*   51
*   52
*   53
*   54
*   55
*   56
*   57
*   58
*   59
*   60
*   61
*   62
*   63
*   64
*   65
*   66
*   67
*   68
*   69
*   70
*   71
*   72


</code></pre></div><blockquote><ul><li>支持进一步选择all、cpu、block io、context switch、page faults等查看其他信息</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>`mysql&gt; show profile cpu for query 3;
+--------------------------------+----------+----------+------------+
| Status                         | Duration | CPU_user | CPU_system |
+--------------------------------+----------+----------+------------+
| starting                       | 0.000082 | 0.000038 |   0.000037 |
| Executing hook on transaction  | 0.000005 | 0.000002 |   0.000003 |
| starting                       | 0.000009 | 0.000004 |   0.000004 |
| checking permissions           | 0.000007 | 0.000004 |   0.000004 |
| Opening tables                 | 0.000034 | 0.000016 |   0.000016 |
| init                           | 0.000006 | 0.000003 |   0.000003 |
| System lock                    | 0.000010 | 0.000005 |   0.000005 |
| optimizing                     | 0.000005 | 0.000002 |   0.000003 |
| statistics                     | 0.000016 | 0.000008 |   0.000007 |
| preparing                      | 0.000022 | 0.000011 |   0.000012 |
| executing                      | 6.691968 | 1.705168 |   0.784907 |
| end                            | 0.000018 | 0.000006 |   0.000006 |
| query end                      | 0.000005 | 0.000002 |   0.000002 |
| waiting for handler commit     | 0.000023 | 0.000012 |   0.000012 |
| closing tables                 | 0.000013 | 0.000006 |   0.000006 |
| freeing items                  | 0.000021 | 0.000011 |   0.000011 |
| logging slow query             | 0.000033 | 0.000017 |   0.000016 |
| cleaning up                    | 0.000015 | 0.000007 |   0.000008 |
+--------------------------------+----------+----------+------------+
18 rows in set, 1 warning (0.00 sec)` ![][img-4]

*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11
*   12
*   13
*   14
*   15
*   16
*   17
*   18
*   19
*   20
*   21
*   22
*   23
*   24


</code></pre></div><h4 id="_2-1-5-trace分析优化器执行计划"><a href="#_2-1-5-trace分析优化器执行计划" class="header-anchor">#</a> 2.1.5 trace分析优化器执行计划</h4> <blockquote><p>trace 用来对SQL进行跟踪，可以了解为什么优化器选择A计划而不是B计划</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>`-- 打开 trace，设置格式为JSON，设置最大使用内存
mysql&gt; set optimizer_trace=&quot;enabled=on&quot;, end_markers_in_json=on;
Query OK, 0 rows affected (0.01 sec)
mysql&gt; set optimizer_trace_max_mem_size=1000000;
Query OK, 0 rows affected (0.02 sec)

-- 进行查询
mysql&gt; select * from user where id &lt;= 4;
+----+----------------------+------+-----------+---------------------+
| id | name                 | age  | address   | birthday            |
+----+----------------------+------+-----------+---------------------+
|  1 | Z7zEgyrL3PJq86sfhas3 |   26 | 云浮市    | 2019-01-13 10:04:55 |
|  2 | MrldItwPeb6VDk7zCOO1 |    2 | 汕尾市    | 2018-10-18 09:41:51 |
|  3 | 5ag8vXuMnV0JRBH2PKkG |   72 | 梅州市    | 2021-06-16 06:22:28 |
|  4 | SccWwgENpikMyriAdJ3V |   12 | 江门市    | 2019-01-17 15:21:14 |
+----+----------------------+------+-----------+---------------------+

-- 查看优化器执行计划
mysql&gt; select * from information_schema.optimizer_trace\G;` ![][img-5]

*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11
*   12
*   13
*   14
*   15
*   16
*   17
*   18
*   19


</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>``QUERY: select * from user where id &lt;= 4
TRACE: {
  &quot;steps&quot;: [
    {
      &quot;join_preparation&quot;: {
        &quot;select#&quot;: 1,
        &quot;steps&quot;: [
          {
            &quot;expanded_query&quot;: &quot;/* select#1 */ select `user`.`id` AS `id`,`user`.`name` AS `name`,`user`.`age` AS `age`,`user`.`address` AS `address`,`user`.`birthday` AS `birthday` from `user` where (`user`.`id` &lt;= 4)&quot;
          }
        ] /* steps */
      } /* join_preparation */
    },
    {
      &quot;join_optimization&quot;: {
        &quot;select#&quot;: 1,
        &quot;steps&quot;: [
          {
            &quot;condition_processing&quot;: {
              &quot;condition&quot;: &quot;WHERE&quot;,
              &quot;original_condition&quot;: &quot;(`user`.`id` &lt;= 4)&quot;,
              &quot;steps&quot;: [
                {
                  &quot;transformation&quot;: &quot;equality_propagation&quot;,
                  &quot;resulting_condition&quot;: &quot;(`user`.`id` &lt;= 4)&quot;
                },
                {
                  &quot;transformation&quot;: &quot;constant_propagation&quot;,
                  &quot;resulting_condition&quot;: &quot;(`user`.`id` &lt;= 4)&quot;
                },
                {
                  &quot;transformation&quot;: &quot;trivial_condition_removal&quot;,
                  &quot;resulting_condition&quot;: &quot;(`user`.`id` &lt;= 4)&quot;
                }
              ] /* steps */
            } /* condition_processing */
          },
          {
            &quot;substitute_generated_columns&quot;: {
            } /* substitute_generated_columns */
          },
          {
            &quot;table_dependencies&quot;: [
              {
                &quot;table&quot;: &quot;`user`&quot;,
                &quot;row_may_be_null&quot;: false,
                &quot;map_bit&quot;: 0,
                &quot;depends_on_map_bits&quot;: [
                ] /* depends_on_map_bits */
              }
            ] /* table_dependencies */
          },
          {
            &quot;ref_optimizer_key_uses&quot;: [
            ] /* ref_optimizer_key_uses */
          },
          {
            &quot;rows_estimation&quot;: [
              {
                &quot;table&quot;: &quot;`user`&quot;,
                &quot;range_analysis&quot;: {
                  &quot;table_scan&quot;: {
                    &quot;rows&quot;: 1902939,
                    &quot;cost&quot;: 192515
                  } /* table_scan */,
                  &quot;potential_range_indexes&quot;: [
                    {
                      &quot;index&quot;: &quot;PRIMARY&quot;,
                      &quot;usable&quot;: true,
                      &quot;key_parts&quot;: [
                        &quot;id&quot;
                      ] /* key_parts */
                    }
                  ] /* potential_range_indexes */,
                  &quot;setup_range_conditions&quot;: [
                  ] /* setup_range_conditions */,
                  &quot;group_index_range&quot;: {
                    &quot;chosen&quot;: false,
                    &quot;cause&quot;: &quot;not_group_by_or_distinct&quot;
                  } /* group_index_range */,
                  &quot;skip_scan_range&quot;: {
                    &quot;potential_skip_scan_indexes&quot;: [
                      {
                        &quot;index&quot;: &quot;PRIMARY&quot;,
                        &quot;usable&quot;: false,
                        &quot;cause&quot;: &quot;query_references_nonkey_column&quot;
                      }
                    ] /* potential_skip_scan_indexes */
                  } /* skip_scan_range */,
                  &quot;analyzing_range_alternatives&quot;: {
                    &quot;range_scan_alternatives&quot;: [
                      {
                        &quot;index&quot;: &quot;PRIMARY&quot;,
                        &quot;ranges&quot;: [
                          &quot;id &lt;= 4&quot;
                        ] /* ranges */,
                        &quot;index_dives_for_eq_ranges&quot;: true,
                        &quot;rowid_ordered&quot;: true,
                        &quot;using_mrr&quot;: false,
                        &quot;index_only&quot;: false,
                        &quot;rows&quot;: 4,
                        &quot;cost&quot;: 0.66107,
                        &quot;chosen&quot;: true
                      }
                    ] /* range_scan_alternatives */,
                    &quot;analyzing_roworder_intersect&quot;: {
                      &quot;usable&quot;: false,
                      &quot;cause&quot;: &quot;too_few_roworder_scans&quot;
                    } /* analyzing_roworder_intersect */
                  } /* analyzing_range_alternatives */,
                  &quot;chosen_range_access_summary&quot;: {
                    &quot;range_access_plan&quot;: {
                      &quot;type&quot;: &quot;range_scan&quot;,
                      &quot;index&quot;: &quot;PRIMARY&quot;,
                      &quot;rows&quot;: 4,
                      &quot;ranges&quot;: [
                        &quot;id &lt;= 4&quot;
                      ] /* ranges */
                    } /* range_access_plan */,
                    &quot;rows_for_plan&quot;: 4,
                    &quot;cost_for_plan&quot;: 0.66107,
                    &quot;chosen&quot;: true
                  } /* chosen_range_access_summary */
                } /* range_analysis */
              }
            ] /* rows_estimation */
          },
          {
            &quot;considered_execution_plans&quot;: [
              {
                &quot;plan_prefix&quot;: [
                ] /* plan_prefix */,
                &quot;table&quot;: &quot;`user`&quot;,
                &quot;best_access_path&quot;: {
                  &quot;considered_access_paths&quot;: [
                    {
                      &quot;rows_to_scan&quot;: 4,
                      &quot;access_type&quot;: &quot;range&quot;,
                      &quot;range_details&quot;: {
                        &quot;used_index&quot;: &quot;PRIMARY&quot;
                      } /* range_details */,
                      &quot;resulting_rows&quot;: 4,
                      &quot;cost&quot;: 1.06107,
                      &quot;chosen&quot;: true
                    }
                  ] /* considered_access_paths */
                } /* best_access_path */,
                &quot;condition_filtering_pct&quot;: 100,
                &quot;rows_for_plan&quot;: 4,
                &quot;cost_for_plan&quot;: 1.06107,
                &quot;chosen&quot;: true
              }
            ] /* considered_execution_plans */
          },
          {
            &quot;attaching_conditions_to_tables&quot;: {
              &quot;original_condition&quot;: &quot;(`user`.`id` &lt;= 4)&quot;,
              &quot;attached_conditions_computation&quot;: [
              ] /* attached_conditions_computation */,
              &quot;attached_conditions_summary&quot;: [
                {
                  &quot;table&quot;: &quot;`user`&quot;,
                  &quot;attached&quot;: &quot;(`user`.`id` &lt;= 4)&quot;
                }
              ] /* attached_conditions_summary */
            } /* attaching_conditions_to_tables */
          },
          {
            &quot;finalizing_table_conditions&quot;: [
              {
                &quot;table&quot;: &quot;`user`&quot;,
                &quot;original_table_condition&quot;: &quot;(`user`.`id` &lt;= 4)&quot;,
                &quot;final_table_condition   &quot;: &quot;(`user`.`id` &lt;= 4)&quot;
              }
            ] /* finalizing_table_conditions */
          },
          {
            &quot;refine_plan&quot;: [
              {
                &quot;table&quot;: &quot;`user`&quot;
              }
            ] /* refine_plan */
          }
        ] /* steps */
      } /* join_optimization */
    },
    {
      &quot;join_execution&quot;: {
        &quot;select#&quot;: 1,
        &quot;steps&quot;: [
        ] /* steps */
      } /* join_execution */
    }
  ] /* steps */
}
MISSING_BYTES_BEYOND_MAX_MEM_SIZE: 0
          INSUFFICIENT_PRIVILEGES: 0
1 row in set (0.01 sec)`` ![][img-6]

*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11
*   12
*   13
*   14
*   15
*   16
*   17
*   18
*   19
*   20
*   21
*   22
*   23
*   24
*   25
*   26
*   27
*   28
*   29
*   30
*   31
*   32
*   33
*   34
*   35
*   36
*   37
*   38
*   39
*   40
*   41
*   42
*   43
*   44
*   45
*   46
*   47
*   48
*   49
*   50
*   51
*   52
*   53
*   54
*   55
*   56
*   57
*   58
*   59
*   60
*   61
*   62
*   63
*   64
*   65
*   66
*   67
*   68
*   69
*   70
*   71
*   72
*   73
*   74
*   75
*   76
*   77
*   78
*   79
*   80
*   81
*   82
*   83
*   84
*   85
*   86
*   87
*   88
*   89
*   90
*   91
*   92
*   93
*   94
*   95
*   96
*   97
*   98
*   99
*   100
*   101
*   102
*   103
*   104
*   105
*   106
*   107
*   108
*   109
*   110
*   111
*   112
*   113
*   114
*   115
*   116
*   117
*   118
*   119
*   120
*   121
*   122
*   123
*   124
*   125
*   126
*   127
*   128
*   129
*   130
*   131
*   132
*   133
*   134
*   135
*   136
*   137
*   138
*   139
*   140
*   141
*   142
*   143
*   144
*   145
*   146
*   147
*   148
*   149
*   150
*   151
*   152
*   153
*   154
*   155
*   156
*   157
*   158
*   159
*   160
*   161
*   162
*   163
*   164
*   165
*   166
*   167
*   168
*   169
*   170
*   171
*   172
*   173
*   174
*   175
*   176
*   177
*   178
*   179
*   180
*   181
*   182
*   183
*   184
*   185
*   186
*   187
*   188
*   189
*   190
*   191
*   192
*   193
*   194
*   195
*   196
*   197
*   198


</code></pre></div><h3 id="_2-2-优化大批量插入"><a href="#_2-2-优化大批量插入" class="header-anchor">#</a> 2.2 优化大批量插入</h3> <blockquote><ul><li><p>使用<code>load</code> 命令导入数据可以适当提高导入效率</p> <p><img src="https://img-blog.csdnimg.cn/14fb19a7f8f8431e9584c4e060892319.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-mMYuVM9A-1628668796602)(resource/1628639972616.png)]"></p></li></ul></blockquote> <blockquote><ul><li>对于InnoDB存储引擎表：
<ul><li>主键采用顺序插入，如果没有主键，InnoDB默认会自动创建一个内部列作为主键</li> <li>关闭唯一性校验：导入前执行<code>set unique_checks=0</code>，导入结束执行<code>set unique_checks=1</code></li> <li>设置手动提交事务，导入前执行<code>set autocommit=0</code>，导入后执行<code>set autocommit=1</code></li></ul></li></ul></blockquote> <h3 id="_2-3-优化insert语句"><a href="#_2-3-优化insert语句" class="header-anchor">#</a> 2.3 优化insert语句</h3> <blockquote><p>合并insert语句：</p> <ul><li><p>优化前：</p> <div class="language- extra-class"><pre class="language-text"><code>`insert into tb_test values(1, 'Tom');
insert into tb_test values(2, 'Cat');
insert into tb_test values(3, 'Jerry');` 
    
*   1
*   2
*   3


</code></pre></div></li> <li><p>优化后：</p> <div class="language- extra-class"><pre class="language-text"><code>`insert into tb_test values(1, 'Tom'),(2, 'Cat'),(3, 'Jerry');` 
    
*   1


</code></pre></div></li></ul></blockquote> <blockquote><p>在事务中提交数据：</p> <div class="language- extra-class"><pre class="language-text"><code>`start transaction;
insert into tb_test values(1, 'Tom');
insert into tb_test values(2, 'Cat');
insert into tb_test values(3, 'Jerry');
commit;` 

*   1
*   2
*   3
*   4
*   5


</code></pre></div></blockquote> <blockquote><p>数据有序插入：</p> <ul><li><p>优化前：</p> <div class="language- extra-class"><pre class="language-text"><code>`insert into tb_test values(3, 'Tom');
insert into tb_test values(2, 'Cat');
insert into tb_test values(1, 'Jerry');` 
    
*   1
*   2
*   3


</code></pre></div></li> <li><p>优化后：</p> <div class="language- extra-class"><pre class="language-text"><code>`insert into tb_test values(1, 'Tom');
insert into tb_test values(2, 'Cat');
insert into tb_test values(3, 'Jerry');` 
    
*   1
*   2
*   3


</code></pre></div></li></ul></blockquote> <h3 id="_2-4-优化order-by语句"><a href="#_2-4-优化order-by语句" class="header-anchor">#</a> 2.4 优化order by语句</h3> <h4 id="_2-4-1-过程"><a href="#_2-4-1-过程" class="header-anchor">#</a> 2.4.1 过程</h4> <p>表存在的索引：</p> <p><img src="https://img-blog.csdnimg.cn/c3e4fd47bd2048009186b7c19625324a.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-vI5T4No0-1628668796604)(resource/1628641131176.png)]"></p> <p>优化前：没有使用索引而是<code>using filesort</code></p> <p><img src="https://img-blog.csdnimg.cn/9409e6c7d653451095cb5cd3db6c19c5.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-3Ef0KVhZ-1628668796606)(resource/1628641186369.png)]"></p> <p>优化后：使用<code>using index</code>【原理是<code>覆盖索引</code>】</p> <p><img src="https://img-blog.csdnimg.cn/1f910684fa41442f8d91fb54f3ceb9c9.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-NGefV0XZ-1628668796608)(resource/1628641231687.png)]"></p> <p>当一个需要升序，一个需要降序时：</p> <p><img src="https://img-blog.csdnimg.cn/c0272e27320e4e24bab79b883f55b0a5.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-gjkyx1IE-1628668796610)(resource/1628641361037.png)]"></p> <p>总结：</p> <blockquote><ul><li>选择字段与排序字段尽量满足<code>覆盖索引</code></li> <li><code>order by</code>字段的顺序应和索引顺序相同，且要么都是升序要么都是降序</li></ul></blockquote> <h4 id="_2-4-2-using-filesort优化"><a href="#_2-4-2-using-filesort优化" class="header-anchor">#</a> 2.4.2 using filesort优化</h4> <p>知识储备：</p> <blockquote><p>MySQL的两个排序算法：</p> <ul><li>两次扫描算法：首先取出排序字段和行指针，然后在排序区【sort buffer】排序，完成排序后根据行指针回表读取记录。【若排序区不足，则在临时表中存储排序结果】可能导致大量的随机IO操作</li> <li>一次扫描算法：一次性取出所需字段，在排序区排序后直接输出结果集，排序区内存开销大，但效率较高</li></ul> <p>MySQL通过比较系统变量<code>max_length_for_sort_date</code>和Query语句取出字段总大小，来哦按段选择哪种排序算法。【<code>max_length_for_sort_data</code>更大则选择一次扫描，否则使用二次扫描】</p></blockquote> <p>优化：</p> <blockquote><p>适当提高<code>sort_buffer_size</code>和<code>max_length_for_sort_data</code>系统变量，增大排序区的大小</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>`mysql&gt; show variables like 'max_length_for_sort_data';
+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| max_length_for_sort_data | 4096  |
+--------------------------+-------+
1 row in set (0.01 sec)

mysql&gt; show variables like 'sort_buffer_size';
+------------------+---------+
| Variable_name    | Value   |
+------------------+---------+
| sort_buffer_size | 1048576 |
+------------------+---------+
1 row in set (0.01 sec)` 

*   1
*   2
*   3
*   4
*   5
*   6
*   7
*   8
*   9
*   10
*   11
*   12
*   13
*   14
*   15


</code></pre></div><h3 id="_2-5-优化group-by语句"><a href="#_2-5-优化group-by语句" class="header-anchor">#</a> 2.5 优化group by语句</h3> <p>优化前：<br> <img src="https://img-blog.csdnimg.cn/246106f3d3364476b4b1a8c3769fb898.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <p>添加索引后：</p> <p><img src="https://img-blog.csdnimg.cn/583d95760fd74e448ed8f155d5901c41.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-yqrJuwm6-1628668796617)(resource/1628649714495.png)]"></p> <h3 id="_2-6-优化嵌套查询"><a href="#_2-6-优化嵌套查询" class="header-anchor">#</a> 2.6 优化嵌套查询</h3> <p>优化前：</p> <p><img src="https://img-blog.csdnimg.cn/6ad6a10f7fbf4ad2a1478d8157af509b.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-VIgUZosj-1628668796621)(resource/1628649938300.png)]"></p> <p>优化方式：使用多表联查替换子查询</p> <p><img src="https://img-blog.csdnimg.cn/9b96aa28c64541bda872fee303f41bbf.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-QPDS9T6r-1628668796623)(resource/1628650000929.png)]"></p> <h3 id="_2-7-优化or条件"><a href="#_2-7-优化or条件" class="header-anchor">#</a> 2.7 优化OR条件</h3> <p>包含or的查询子句，需要每个or条件都用到索引，且不能使用到复合索引，否则索引失效进行全表扫描</p> <p>优化前：</p> <p><img src="https://img-blog.csdnimg.cn/1c2e4d66eb8842d2bb8257256d6800bf.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-oFAwlcss-1628668796626)(resource/1628650286966.png)]"></p> <p>优化一，设置索引：</p> <p><img src="https://img-blog.csdnimg.cn/00a892ee657f49dfa818f53743bc75d8.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-rtOv0Cxd-1628668796627)(resource/1628650402087.png)]"></p> <p>优化二，使用Union：</p> <p><img src="https://img-blog.csdnimg.cn/9efc3320d4864a6dbbc1763ff72d9948.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-8eprE2GF-1628668796629)(resource/1628650538794.png)]"></p> <h3 id="_2-8-优化分页查询"><a href="#_2-8-优化分页查询" class="header-anchor">#</a> 2.8 优化分页查询</h3> <p>一般分页查询通过创建覆盖索引能够获得比较好的性能。但是数据量过大时【百万级】当执行<code>limit 1000000 10</code>时，需要MySQL排序前1000010记录，但只返回1000000~1000010记录，其他丢弃，代价非常大</p> <p><img src="https://img-blog.csdnimg.cn/127f7d855d444ae2afc49c2e7d56558e.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-XKZkNYXP-1628668796631)(resource/1628661168852.png)]"></p> <p>优化一：在索引上完成排序分页操作，根据主键关联原表查询所需内容</p> <p><img src="https://img-blog.csdnimg.cn/ca554442d0e742f596b9e1433e793447.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-OG4uQwUA-1628668796633)(resource/1628661383957.png)]"></p> <p>优化二：把limit查询转换成某个位置的查询【仅适应主键自增表，且中间没有断层】</p> <p><img src="https://img-blog.csdnimg.cn/6e0d6961f1f84e489278ff21f73027c3.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Yq7wWLYp-1628668796634)(resource/1628661527734.png)]"></p> <h3 id="_2-9-使用sql提示"><a href="#_2-9-使用sql提示" class="header-anchor">#</a> 2.9 使用SQL提示</h3> <p>通过显性SQL命令建议【强制】MySQL执行某些操作</p> <h4 id="_2-9-1-use-index"><a href="#_2-9-1-use-index" class="header-anchor">#</a> 2.9.1 USE INDEX</h4> <p>【建议MySQL使用哪个索引】</p> <p><img src="https://img-blog.csdnimg.cn/55590cf5a64c4e02a43aad2fd4ff4e56.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-YnMHVzCO-1628668796636)(resource/1628662123308.png)]"></p> <h4 id="_2-9-2-igonre-index"><a href="#_2-9-2-igonre-index" class="header-anchor">#</a> 2.9.2 IGONRE INDEX</h4> <p>【建议MySQL忽略哪个索引】</p> <p><img src="https://img-blog.csdnimg.cn/8e70aa29d4de4294ab60fae4cfa7a1ed.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-I2wGj8QW-1628668796638)(resource/1628662233088.png)]"></p> <h4 id="_2-9-3-force-index"><a href="#_2-9-3-force-index" class="header-anchor">#</a> 2.9.3 FORCE INDEX</h4> <p>【强制MySQL使用哪个索引】</p> <p><img src="https://img-blog.csdnimg.cn/fa1c020290e042ee956ffcb93bc1ffcf.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjk0ODkzNQ==,size_16,color_FFFFFF,t_70" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-xjyN7vEX-1628668796640)(resource/1628662495378.png)]"></p> <ol start="3"><li>应用优化</li></ol> <hr> <blockquote><ul><li>使用数据库连接池</li> <li>减少对MySQL的访问：
<ul><li>避免对数据进行重复检索。比如：<code>select id,name from user</code>和<code>select id,status from user</code> 可以合并为<code>select id, name, status from user</code></li> <li>增加缓存层。比如使用<code>Redis</code> 或者 <code>ORM框架提供的缓存</code></li></ul></li> <li>进行负载均衡：
<ul><li>利用MySQL主从复制实现读写分离</li> <li>采用分布式数据库架构【分库分表】</li></ul></li></ul></blockquote> <ol start="4"><li>内存管理优化</li></ol> <hr> <h3 id="_4-1-优化原则"><a href="#_4-1-优化原则" class="header-anchor">#</a> 4.1 优化原则</h3> <blockquote><ul><li>在OS及其他程序正常运行的情况下，尽量多的给MySQL分配内存</li> <li>MyISAM存储引擎的数据文件读取依赖OS自身的IO缓存，故需要预留更多的内存给OS</li> <li>排序区、连接区的缓存时分配给每个session专用的，其值的设置需要根据最大连接数合理分配</li></ul></blockquote> <h3 id="_4-2-myisam内存优化"><a href="#_4-2-myisam内存优化" class="header-anchor">#</a> 4.2 MyISAM内存优化</h3> <p>MyISAM存储引擎使用<code>key_buffer</code>缓存索引块，加锁索引读写。对于表则没有缓存机制，需要依赖操作系统的IO缓存</p> <p>key_buffer_size：设置缓存块大小，建议至少1/4可用内存</p> <div class="language- extra-class"><pre class="language-text"><code>`key_buffer_size=512M` 

*   1


</code></pre></div><p>read_buffer_size：若需要经常顺序扫描表，可以增大该值，但是该值为session独占</p> <p>read_rnd_buffer_size：需要做排序的表查询，可以适当增加该值，但是该值为session独占</p> <h3 id="_4-3-innodb内存优化"><a href="#_4-3-innodb内存优化" class="header-anchor">#</a> 4.3 InnoDB内存优化</h3> <p>InnoDB使用一块内存区作为IO缓冲池，用来缓存索引块和数据块</p> <p>innodb_buffer_pool_size：决定最大缓存区大小，该值越大则命中率越高，磁盘IO操作越少</p> <div class="language- extra-class"><pre class="language-text"><code>`innodb_buffer_pool_size=512M` 

*   1


</code></pre></div><p>innodb_log_buffer_size：重做日志缓存的大小，对于可能产生大量更新记录的大事务，增加该值可以避免在事务提交前就执行不必要的日志写入磁盘的操作</p> <div class="language- extra-class"><pre class="language-text"><code>`innodb_log_buffer_size=10M` 

*   1


</code></pre></div><ol start="5"><li>并发参数优化</li></ol> <hr> <p>MySQL Server是多线程结构的，包括后台线程和客户服务线程。其中控制并发连接和线程的主要参数为：<code>max_connections</code>、<code>back_log</code>、<code>thread_cache_size</code>、<code>table_open_cache</code></p> <h3 id="_5-1-max-connections"><a href="#_5-1-max-connections" class="header-anchor">#</a> 5.1 max_connections</h3> <p>控制允许连接到MySQL的最大连接量。默认值<code>151</code>。如果状态变量<code>connection_errors_max_connections</code>不为0且一直增长，说明不断一连接请求因数据库连接数已达到最大而失败，这时可以考虑增加<code>max_connections</code></p> <p>MySQL最大可支持连接数取决很多因素：</p> <ul><li>给定OS平台的线程库质量</li> <li>内存大小</li> <li>每个连接的负荷</li> <li>CPU处理速度</li> <li>期望的响应时间等</li></ul> <h3 id="_5-2-back-log"><a href="#_5-2-back-log" class="header-anchor">#</a> 5.2 back_log</h3> <blockquote><ul><li>控制MySQL监听TCP端口时设置的积压请求栈大小。当连接数到达<code>max_connections</code>，新来的请求会被存储在积压栈中等待。若等待数量超过<code>back_log</code>，则拒绝连接，并报错。</li> <li>5.6.6版本之前默认值为<code>50</code>，新版本默认为<code>50 + max_connections/5</code>，最大不超过900</li></ul></blockquote> <h3 id="_5-3-table-open-cache"><a href="#_5-3-table-open-cache" class="header-anchor">#</a> 5.3 table_open_cache</h3> <blockquote><ul><li>控制所有SQL语句执行线程可以打开表缓存的数量</li> <li>在执行SQL语句时，每个SQL执行线程至少要打开1个表缓存。</li> <li>该参数的值应该根据设置的最大连接数<code>max_connections</code>以及每个连接执行关联查询中设计的表的最大数量来设定：<code>max_connections * N</code></li></ul></blockquote> <h3 id="_5-4-thread-cache-size"><a href="#_5-4-thread-cache-size" class="header-anchor">#</a> 5.4 thread_cache_size</h3> <p>为了加快连接数据库的速度，MySQL会缓存一定数量的客户服务线程以备重用。</p> <h3 id="_5-5-innodb-lock-wait-timeout"><a href="#_5-5-innodb-lock-wait-timeout" class="header-anchor">#</a> 5.5 innodb_lock_wait_timeout</h3> <p>设置InnoDB事务等待行锁的时间，默认值为<code>50ms</code>。</p> <ul><li>对于需要快速反馈的业务系统，可以设置小些，以免事务长时间挂起</li> <li>对于后台运行的批处理程序，可以设置大些，以免发生大的回滚操作</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/orangbus/vuepress-blog/edit/master/docs/WebNote/MySQL性能优化详解.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">8/6/2022, 2:00:03 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/WebNote/Linux环境下MySQL8.0安装.html" class="prev">
        Linux环境下MySQL8.0安装
      </a></span> <span class="next"><a href="/WebNote/" class="router-link-active">
        十个催泪虐心的小故事
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div class="reading-progress top" data-v-21b39eda><div class="progress" data-v-21b39eda></div></div></div></div>
    <script src="/assets/js/app.0b830e2b.js" defer></script><script src="/assets/js/3.6c5e3284.js" defer></script><script src="/assets/js/134.2ddb71dd.js" defer></script>
  </body>
</html>
