(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{644:function(s,a,e){"use strict";e.r(a);var t=e(11),l=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h3",{attrs:{id:"一、准备工作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、准备工作"}},[s._v("#")]),s._v(" 一、准备工作")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("下载安装包 "),e("a",{attrs:{href:"https://link.segmentfault.com/?enc=dQkSxf%2BypD3YlhlgO9lFaQ%3D%3D.72gQuzAR%2BI5Ymm75CyWIBsg8fQrYb1TRAuT5F79F0osHaeIszE3XVK7uzxVx2m%2Bk",target:"_blank",rel:"noopener noreferrer"}},[s._v("下载地址"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[s._v("查看系统⾃带的 "),e("code",[s._v("MARIADB")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("rpm -qa|grep mariadb\n")])])])]),s._v(" "),e("li",[e("p",[s._v("卸载系统⾃带的 "),e("code",[s._v("MARIADB")]),s._v("（如果有）,remove后面加 "),e("code",[s._v("rpm -qa|grep mariadb")]),s._v(" 查询出来的路径")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yum -y remove\n")])])])])]),s._v(" "),e("h3",{attrs:{id:"二、解压"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、解压"}},[s._v("#")]),s._v(" 二、解压")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("将 "),e("code",[s._v("mysql-8.0.26-linux-glibc2.12-x86_64.tar.xz")]),s._v(" 安装包上传到 "),e("code",[s._v("/usr/local/")]),s._v(" 目录下")])]),s._v(" "),e("li",[e("p",[s._v("安装包解压,并重命名为mysql")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("xz -d mysql-8.0.26-linux-glibc2.12-x86_64.tar.xz\ntar -xvf mysql-8.0.26-linux-glibc2.12-x86_64.tar \nmv mysql-8.0.26-linux-glibc2.12-x86_64 mysql\n")])])])]),s._v(" "),e("li",[e("p",[s._v("创建MYSQL⽤户和⽤户组")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("groupadd mysql\nuseradd -g mysql mysql\n")])])])]),s._v(" "),e("li",[e("p",[s._v("修改MYSQL⽬录的归属⽤户")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("chown -R mysql:mysql ./\n")])])])]),s._v(" "),e("li",[e("p",[s._v("准备MYSQL的配置⽂件,编辑 "),e("code",[s._v("vim /etc/my.cnf")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[mysql]\n# 设置mysql客户端默认字符集\ndefault-character-set=utf8\nsocket=/var/lib/mysql/mysql.sock\n[mysqld]\nskip-name-resolve\n#设置3306端⼝\nport = 3306\nsocket=/var/lib/mysql/mysql.sock\n# 设置mysql的安装⽬录\nbasedir=/usr/local/mysql\n# 设置mysql数据库的数据的存放⽬录\ndatadir=/usr/local/mysql/data\n# 允许最⼤连接数\nmax_connections=200\n# 服务端使⽤的字符集默认为8⽐特编码的latin1字符集\ncharacter-set-server=utf8\n# 创建新表时将使⽤的默认存储引擎\ndefault-storage-engine=INNODB\nlower_case_table_names=1\nmax_allowed_packet=16M\n# binglog配置\nserver-id = 1\nlog-bin = mysql-bin\nlog_bin_index = binlog.index\nbinlog_format = ROW\n# binlog过期清理时间；\nexpire_logs_days= 7\n# binlog每个日志文件大小；\nmax_binlog_size = 1024m\n# binlog缓存大小；\nbinlog_cache_size = 128m\n# 最大binlog缓存大小。\nmax_binlog_cache_size = 1024m\n")])])]),e("p",[s._v("并且修改权限")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mkdir /var/lib/mysql \nchmod 777 /var/lib/mysql\n")])])])])]),s._v(" "),e("h3",{attrs:{id:"三、-安装mysql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、-安装mysql"}},[s._v("#")]),s._v(" 三、 安装MySQL")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("进入"),e("code",[s._v("cd /usr/local/mysql")]),s._v(" 目录 进行初始化")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("./bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data\n")])])])]),s._v(" "),e("li",[e("p",[s._v("执行初始化后,控制台会返回临时密码, "),e("code",[s._v("记录临时密码")]),s._v(" ,后面会用到"),e("br"),s._v(" "),e("code",[s._v("例如:")]),s._v("像我的例子在最后一行 A temporary password is generated for root@localhost:"),e("code",[s._v("kvct:yIy8_qk")]),e("br"),s._v("\n我的临时密码就是这个: "),e("code",[s._v("kvct:yIy8_qk")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("例子:\n2021-09-14T01:30:19.227943Z 0 [System] [MY-013169] [Server] /usr/local/mysql/bin/mysqld (mysqld 8.0.26) initializing of server in progress as process 1808\n2021-09-14T01:30:19.250431Z 1 [System] [MY-013576] [InnoDB] InnoDB initialization has started.\n2021-09-14T01:30:20.184005Z 1 [System] [MY-013577] [InnoDB] InnoDB initialization has ended.\n2021-09-14T01:30:21.140583Z 0 [Warning] [MY-013746] [Server] A deprecated TLS version TLSv1 is enabled for channel mysql_main\n2021-09-14T01:30:21.141148Z 0 [Warning] [MY-013746] [Server] A deprecated TLS version TLSv1.1 is enabled for channel mysql_main\n2021-09-14T01:30:21.341903Z 6 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: kvct:yIy8_qk\n")])])])]),s._v(" "),e("li",[e("p",[s._v("复制启动脚本到资源目录")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cp ./support-files/mysql.server /etc/init.d/mysqld\n")])])])]),s._v(" "),e("li",[e("p",[s._v("编辑"),e("code",[s._v("vim /etc/init.d/mysqld")]),s._v(" ,修改 "),e("code",[s._v("basedir")]),s._v(" 和 "),e("code",[s._v("datadir")]),s._v(" ,为其实际对应的目录")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("basedir=/usr/local/mysql \ndatadir=/usr/local/mysql/data\n")])])])])]),s._v(" "),e("h3",{attrs:{id:"四、设置mysql服务开机自启"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四、设置mysql服务开机自启"}},[s._v("#")]),s._v(" 四、设置MYSQL服务开机自启")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("增加 mysqld 服务控制脚本执⾏权限")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("chmod +x /etc/init.d/mysqld\n")])])])]),s._v(" "),e("li",[e("p",[s._v("将 mysqld 服务加⼊到系统服务")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("chkconfig --add mysqld\n")])])])]),s._v(" "),e("li",[e("p",[s._v("检查 mysqld 服务是否已经⽣效即可"),e("br"),s._v(" "),e("code",[s._v("mysqld 0:关 1:关 2:开 3:开 4:开 5:开 6:关")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("chkconfig --list mysqld\n")])])])]),s._v(" "),e("li",[e("p",[s._v("启动 "),e("code",[s._v("mysql")]),s._v(" 服务, 返回 "),e("code",[s._v("SUCCESS!")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("service mysqld start\n")])])]),e("p",[s._v("如何停止 "),e("code",[s._v("mysql")]),s._v(" 服务")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" service mysqld stop\n")])])]),e("h3",{attrs:{id:"五、配置环境变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五、配置环境变量"}},[s._v("#")]),s._v(" 五、配置环境变量")])]),s._v(" "),e("li",[e("p",[s._v("编辑 "),e("code",[s._v("vim ~/.bash_profile")]),s._v(",在文件末尾添加下面信息")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("export PATH=$PATH:/usr/local/mysql/bin\n")])])])]),s._v(" "),e("li",[e("p",[s._v("执行下面命令,使环境变量生效")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("source ~/.bash_profile\n")])])])])]),s._v(" "),e("h3",{attrs:{id:"六、登录mysql，并修改密码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#六、登录mysql，并修改密码"}},[s._v("#")]),s._v(" 六、登录MySQL，并修改密码")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("以 root 账户登录 mysql")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql -u root -p\n")])])])]),s._v(" "),e("li",[e("p",[s._v("输入刚才记录的 "),e("code",[s._v("临时密码")])])]),s._v(" "),e("li",[e("p",[s._v("修改 "),e("code",[s._v("Root")]),s._v(" 账户密码,并刷新权限")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('alter user user() identified by "root";\nflush privileges;\n')])])])]),s._v(" "),e("li",[e("p",[s._v("设置远程主机登录")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("use mysql;\nupdate user set user.Host='%' where user.User='root';\nflush privileges;\n")])])])])]),s._v(" "),e("h3",{attrs:{id:"七、检查防火墙"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#七、检查防火墙"}},[s._v("#")]),s._v(" 七、检查防火墙")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("做完上面步骤,肯能还是远程连接不上,开放端口或者关闭防火墙")])]),s._v(" "),e("li",[e("p",[s._v("查看防火墙状态")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("systemctl status firewalld\n")])])])]),s._v(" "),e("li",[e("p",[s._v("查看开机是否启动防火墙服务")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("systemctl is-enabled firewalld\n")])])])]),s._v(" "),e("li",[e("p",[s._v("关闭防火墙")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("systemctl stop firewalld\n")])])])]),s._v(" "),e("li",[e("p",[s._v("禁用防火墙（系统启动时不启动防火墙服务）")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("systemctl disable firewalld\nsystemctl is-enabled firewalld\n")])])])]),s._v(" "),e("li",[e("p",[s._v("开放端口")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("firewall-cmd --zone=public --add-port=3306/tcp --permanent\nfirewall-cmd --reload   # 配置立即生效 \n")])])])]),s._v(" "),e("li",[e("p",[s._v("关闭端口")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("firewall-cmd --zone=public --remove-port=3306/tcp --permanent\nfirewall-cmd --reload   # 配置立即生效\n")])])])]),s._v(" "),e("li",[e("p",[s._v("查看防火墙所有开放的端口")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("firewall-cmd --zone=public --list-ports\n")])])])]),s._v(" "),e("li",[e("p",[s._v("查看监听的端口"),e("br"),s._v("\ncentos7默认没有 netstat 命令，需要安装 net-tools 工具，"),e("code",[s._v("yum install -y net-tools")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("netstat -lnpt\n")])])])]),s._v(" "),e("li",[e("p",[s._v("检查端口被哪个进程占用")])])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("```\nnetstat -lnpt |grep 3306\n```\n")])])]),e("ol",{attrs:{start:"11"}},[e("li",[s._v("查看进程的详细信息")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("```\nps 6832\n```\n")])])]),e("ol",{attrs:{start:"12"}},[e("li",[s._v("查看包含 "),e("code",[s._v("mysql")]),s._v(" 的所有进程")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("```\nps -ef | grep mysql\n```\n")])])]),e("ol",{attrs:{start:"13"}},[e("li",[s._v("中止进程")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("```\nkill -9 6832\n```\n")])])]),e("h3",{attrs:{id:"八、忘记-mysql-密码-找回密码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#八、忘记-mysql-密码-找回密码"}},[s._v("#")]),s._v(" 八、忘记 "),e("code",[s._v("mysql")]),s._v(" 密码, 找回密码")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("停止 "),e("code",[s._v("mysql")]),s._v(" 服务")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" service mysqld stop\n")])])])]),s._v(" "),e("li",[e("p",[s._v("修改 "),e("code",[s._v("mysql")]),s._v(" 的配置文件 "),e("code",[s._v("my.cnf")]),e("br"),s._v(" "),e("code",[s._v("my.cnf")]),s._v(" 配置文件的位置，一般在 "),e("code",[s._v("/etc/my.cnf")]),s._v(" ，有些版本在 "),e("code",[s._v("/etc/mysql/my.cnf")]),e("br"),s._v("\n在配置文件中添加下面代码, "),e("code",[s._v("安全模式启动")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[mysqld]\nskip-grant-tables\n")])])])]),s._v(" "),e("li",[e("p",[s._v("启动 "),e("code",[s._v("mysql")]),s._v(" 服务")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("service mysqld start\n")])])])]),s._v(" "),e("li",[e("p",[s._v("进入 "),e("code",[s._v("mysql")]),s._v(", 这样可以不用输入密码进入 "),e("code",[s._v("mysql")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql -u root \n")])])]),e("p",[s._v("修改密码, 并刷新权限;")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('mysql> use mysql;\nDatabase changed\nmysql> update user set authentication_string="123456" where user="root";\nQuery OK, 0 rows affected (0.00 sec)\nRows matched: 1  Changed: 0  Warnings: 0\nmysql> flush privileges;\nQuery OK, 0 rows affected (0.00 sec)\n')])])])]),s._v(" "),e("li",[e("p",[s._v("将刚才新添加的配置文件 "),e("code",[s._v("my.cnf")]),s._v(" 删除这两行")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[mysqld]\nskip-grant-tables\n")])])])]),s._v(" "),e("li",[e("p",[s._v("重新启动 "),e("code",[s._v("mysql")]),s._v(" 服务")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("service mysqld start\n")])])]),e("p",[e("code",[s._v("MYSQL 8.0")]),s._v(" 默认user表")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> select host, user, authentication_string, plugin from user;\n+-----------+------------------+------------------------------------------------------------------------+-----------------------+\n| host      | user             | authentication_string                                                  | plugin                |\n+-----------+------------------+------------------------------------------------------------------------+-----------------------+\n| %         | root             | $A$005$\v_N6\nHbERn<n&lg8k*XmaW25XLFVs8MDOgM1K18egNm1p87ttKMQ9Awcf0/rUA  | caching_sha2_password |\n| localhost | mysql.infoschema | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | caching_sha2_password |\n| localhost | mysql.session    | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | caching_sha2_password |\n| localhost | mysql.sys        | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | caching_sha2_password |\n+-----------+------------------+------------------------------------------------------------------------+-----------------------+\n")])])])])]),s._v(" "),e("h3",{attrs:{id:"九、access-denied-for-user-root-localhost-using-password-yes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#九、access-denied-for-user-root-localhost-using-password-yes"}},[s._v("#")]),s._v(" 九、Access denied for user 'root'@'localhost' (using password: YES)")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("安全模式启动 "),e("code",[s._v("mysql服务")]),s._v(",先将密码设置为空")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("use mysql;\nupdate user set authentication_string='' where user='root';\n")])])])]),s._v(" "),e("li",[e("p",[s._v("在重新设置密码, 刷新权限")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('use mysql;\nalter user user() identified by "root";\nflush privileges;\n')])])])])])])}),[],!1,null,null,null);a.default=l.exports}}]);