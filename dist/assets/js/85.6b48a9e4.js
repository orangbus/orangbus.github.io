(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{585:function(e,n,r){"use strict";r.r(n);var a=r(11),o=Object(a.a)({},(function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("blockquote",[r("p",[e._v("本文由 "),r("a",{attrs:{href:"http://ksria.com/simpread/",target:"_blank",rel:"noopener noreferrer"}},[e._v("简悦 SimpRead"),r("OutboundLink")],1),e._v(" 转码， 原文地址 "),r("a",{attrs:{href:"https://it9527.blog.csdn.net/article/details/99982965",target:"_blank",rel:"noopener noreferrer"}},[e._v("it9527.blog.csdn.net"),r("OutboundLink")],1)])]),e._v(" "),r("h2",{attrs:{id:"版权声明"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#版权声明"}},[e._v("#")]),e._v(" "),r("strong",[e._v("版权声明")])]),e._v(" "),r("ul",[r("li",[e._v("本文原创作者："),r("a",{attrs:{href:"http://blog.csdn.net/lfdfhl",target:"_blank",rel:"noopener noreferrer"}},[e._v("谷哥的小弟"),r("OutboundLink")],1)]),e._v(" "),r("li",[e._v("作者博客地址："),r("a",{attrs:{href:"http://blog.csdn.net/lfdfhl",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://blog.csdn.net/lfdfhl"),r("OutboundLink")],1)])]),e._v(" "),r("h2",{attrs:{id:"log4j概述"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#log4j概述"}},[e._v("#")]),e._v(" "),r("strong",[e._v("log4j概述")])]),e._v(" "),r("p",[e._v("log4j是Apache提供的的开源的日志组件，提供强大而且方便的日志记录功能。开发者可在其"),r("a",{attrs:{href:"https://logging.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方网站"),r("OutboundLink")],1),e._v("免费下载Log4j最新版本的软件包。")]),e._v(" "),r("p",[e._v("在log4j中，定义了多种日志级别；但是，Log4j建议只使用其中四个级别，它们的优先级从低到高分别是DEBUG、INFO、WARN、ERROR 。假若设定日志输入的级别为INFO，则只处理等于或高于该级别的日志。")]),e._v(" "),r("h2",{attrs:{id:"log4j-properties配置文件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#log4j-properties配置文件"}},[e._v("#")]),e._v(" "),r("strong",[e._v("log4j.properties配置文件")])]),e._v(" "),r("p",[e._v("在log4j.properties配置文件中主要配置三大组件：")]),e._v(" "),r("p",[r("strong",[e._v("Logger")]),r("br"),e._v("\n指定日志类别和级别")]),e._v(" "),r("p",[r("strong",[e._v("appender")]),r("br"),e._v("\n指定日志输出的位置")]),e._v(" "),r("p",[r("strong",[e._v("layout")]),r("br"),e._v("\n指定日志以何种形式输出")]),e._v(" "),r("p",[e._v("现对其分别介绍，详情如下。")]),e._v(" "),r("h3",{attrs:{id:"logger"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#logger"}},[e._v("#")]),e._v(" "),r("strong",[e._v("logger")])]),e._v(" "),r("p",[e._v("Logger中，最常用的为rootLogger，其语法如下：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("`log4j.rootLogger = level,appenderName1,appenderName2, .....` \n")])])]),r("p",[e._v("level用于设定日志的优先级；appenderName为appender的名字，用于设定日志的输出位置，log4j中可设置多个appenderName。")]),e._v(" "),r("h3",{attrs:{id:"appender"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#appender"}},[e._v("#")]),e._v(" "),r("strong",[e._v("appender")])]),e._v(" "),r("p",[e._v("在Log4j中提供以下5种appender用于对日志信息进行不同的处理：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("`org.apache.log4j.ConsoleAppender  \n表示将信息输出到控制台\n\norg.apache.log4j.FileAppender\n表示将信息输出到文件\n\norg.apache.log4j.DailyRollingFileAppender\n表示每天产生一个日志文件\n\norg.apache.log4j.RollingFileAppender\n表示当日志文件到达指定大小时产生一个新的文件\n\norg.apache.log4j.WriterAppender\n表示将日志信息以流格式发送到任意指定的地方` \n")])])]),r("p",[e._v("每种appender的配置格式如下：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("`log4j.appender.appenderName = Log4j提供的appender类\nlog4j.appender.appenderName.属性名 = 属性值\n.....\nlog4j.appender.appenderName.属性名 = 属性值` \n")])])]),r("p",[e._v("各appender常见配置示例如下：")]),e._v(" "),r("p",[r("strong",[e._v("ConsoleAppender")])]),e._v(" "),r("p",[e._v("Threshold = DEBUG"),r("br"),e._v("\n指定日志消息的输出最低层次"),r("br"),e._v("\nImmediateFlush = TRUE"),r("br"),e._v("\n默认值是true,所有的消息都会被立即输出"),r("br"),e._v("\nTarget = System.err"),r("br"),e._v("\n默认值System.out,输出到控制台(err为红色,out为黑色)")]),e._v(" "),r("p",[r("strong",[e._v("FileAppender")])]),e._v(" "),r("p",[e._v("Threshold = INFO"),r("br"),e._v("\n指定日志消息的输出最低层次"),r("br"),e._v("\nImmediateFlush = TRUE"),r("br"),e._v("\n默认值是true,所有的消息都会被立即输出"),r("br"),e._v("\nFile = C:\\log4j.log"),r("br"),e._v("\n指定消息输出到C:\\log4j.log文件"),r("br"),e._v("\nAppend = FALSE"),r("br"),e._v("\n将消息追加到指定文件中，false指将消息覆盖指定的文件内容 ；默认值true"),r("br"),e._v("\nEncoding = UTF-8"),r("br"),e._v("\n可以指定文件编码格式")]),e._v(" "),r("p",[r("strong",[e._v("DailyRollingFileAppender")])]),e._v(" "),r("p",[e._v("Threshold = WARN"),r("br"),e._v("\n指定日志消息的输出最低层次"),r("br"),e._v("\nImmediateFlush = TRUE"),r("br"),e._v("\n默认值是true,所有的消息都会被立即输出"),r("br"),e._v("\nFile =C:\\log4j.log"),r("br"),e._v("\n指定消息输出到C:\\log4j.log文件"),r("br"),e._v("\nAppend= FALSE"),r("br"),e._v("\n默认值true,将消息追加到指定文件中，false指将消息覆盖指定的文件内容"),r("br"),e._v("\nDatePattern=’.'yyyy-ww"),r("br"),e._v("\n每周滚动一次文件,即每周产生一个新的文件。"),r("br"),e._v("\n还可以按用以下参数:"),r("br"),e._v("\n'.'yyyy-MM:每月"),r("br"),e._v("\n'.'yyyy-ww:每周"),r("br"),e._v("\n'.'yyyy-MM-dd:每天"),r("br"),e._v("\n'.'yyyy-MM-dd-a:每天两次"),r("br"),e._v("\n'.'yyyy-MM-dd-HH:每小时"),r("br"),e._v("\n'.'yyyy-MM-dd-HH-mm:每分钟"),r("br"),e._v("\nEncoding = UTF-8:可以指定文件编码格式")]),e._v(" "),r("p",[r("strong",[e._v("RollingFileAppender")])]),e._v(" "),r("p",[e._v("Threshold = ERROR"),r("br"),e._v("\n指定日志消息的输出最低层次"),r("br"),e._v("\nImmediateFlush = TRUE"),r("br"),e._v("\n默认值是true,所有的消息都会被立即输出"),r("br"),e._v("\nFile =C:/log4j.log"),r("br"),e._v("\n指定消息输出到C:/log4j.log文件"),r("br"),e._v("\nAppend= FALSE"),r("br"),e._v("\n默认值true,将消息追加到指定文件中，false指将消息覆盖指定的文件内容"),r("br"),e._v("\nMaxFileSize = 100KB"),r("br"),e._v("\n后缀可以是KB,MB,GB.在日志文件到达该大小时,将会自动滚动.如:log4j.log.1"),r("br"),e._v("\nMaxBackupIndex = 2"),r("br"),e._v("\n指定可以产生的滚动文件的最大数"),r("br"),e._v("\nEncoding = UTF-8"),r("br"),e._v("\n可以指定文件编码格式")]),e._v(" "),r("h3",{attrs:{id:"layout"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#layout"}},[e._v("#")]),e._v(" "),r("strong",[e._v("layout")])]),e._v(" "),r("p",[e._v("Log4j常用layout如下：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("`org.apache.log4j.HTMLLayout\n以HTML表格形式布局\n\norg.apache.log4j.PatternLayout\n可以灵活地指定布局模式\n\norg.apache.log4j.SimpleLayout\n包含日志信息的级别和信息字符串\n\norg.apache.log4j.TTCCLayout\n包含日志产生的时间、线程、类别等等信息` \n")])])]),r("h2",{attrs:{id:"log4j使用示例"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#log4j使用示例"}},[e._v("#")]),e._v(" "),r("strong",[e._v("log4j使用示例")])]),e._v(" "),r("p",[r("strong",[e._v("第一步")])]),e._v(" "),r("p",[e._v("在其官网下载jar包并导入项目")]),e._v(" "),r("p",[r("strong",[e._v("第二步")])]),e._v(" "),r("p",[e._v("在项目src文件夹下建立log4j.properties文件并对log4j进行配置，代码如下：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("`log4j.rootLogger=DEBUG,console,dailyFile,im\nlog4j.additivity.org.apache=true\n# 控制台(console)\nlog4j.appender.console=org.apache.log4j.ConsoleAppender\nlog4j.appender.console.Threshold=DEBUG\nlog4j.appender.console.ImmediateFlush=true\nlog4j.appender.console.Target=System.err\nlog4j.appender.console.layout=org.apache.log4j.PatternLayout\nlog4j.appender.console.layout.ConversionPattern=[%-5p] %d(%r) --\x3e [%t] %l: %m %x %n\n# 日志文件(logFile)\nlog4j.appender.logFile=org.apache.log4j.FileAppender\nlog4j.appender.logFile.Threshold=DEBUG\nlog4j.appender.logFile.ImmediateFlush=true\nlog4j.appender.logFile.Append=true\nlog4j.appender.logFile.File=D:/logs/log.log4j\nlog4j.appender.logFile.layout=org.apache.log4j.PatternLayout\nlog4j.appender.logFile.layout.ConversionPattern=[%-5p] %d(%r) --\x3e [%t] %l: %m %x %n\n# 回滚文件(rollingFile)\nlog4j.appender.rollingFile=org.apache.log4j.RollingFileAppender\nlog4j.appender.rollingFile.Threshold=DEBUG\nlog4j.appender.rollingFile.ImmediateFlush=true\nlog4j.appender.rollingFile.Append=true\nlog4j.appender.rollingFile.File=D:/logs/log.log4j\nlog4j.appender.rollingFile.MaxFileSize=200KB\nlog4j.appender.rollingFile.MaxBackupIndex=50\nlog4j.appender.rollingFile.layout=org.apache.log4j.PatternLayout\nlog4j.appender.rollingFile.layout.ConversionPattern=[%-5p] %d(%r) --\x3e [%t] %l: %m %x %n\n# 定期回滚日志文件(dailyFile)\nlog4j.appender.dailyFile=org.apache.log4j.DailyRollingFileAppender\nlog4j.appender.dailyFile.Threshold=DEBUG\nlog4j.appender.dailyFile.ImmediateFlush=true\nlog4j.appender.dailyFile.Append=true\nlog4j.appender.dailyFile.File=D:/logs/log.log4j\nlog4j.appender.dailyFile.DatePattern='.'yyyy-MM-dd\nlog4j.appender.dailyFile.layout=org.apache.log4j.PatternLayout\nlog4j.appender.dailyFile.layout.ConversionPattern=[%-5p] %d(%r) --\x3e [%t] %l: %m %x %n\n# 应用于socket\nlog4j.appender.socket=org.apache.log4j.RollingFileAppender\nlog4j.appender.socket.RemoteHost=localhost\nlog4j.appender.socket.Port=5001\nlog4j.appender.socket.LocationInfo=true\n# Set up for Log Factor 5\nlog4j.appender.socket.layout=org.apache.log4j.PatternLayout\nlog4j.appender.socket.layout.ConversionPattern=[%-5p] %d(%r) --\x3e [%t] %l: %m %x %n\n# Log Factor 5 Appender\nlog4j.appender.LF5_APPENDER=org.apache.log4j.lf5.LF5Appender\nlog4j.appender.LF5_APPENDER.MaxNumberOfRecords=2000\n# 发送日志到指定邮件\nlog4j.appender.mail=org.apache.log4j.net.SMTPAppender\nlog4j.appender.mail.Threshold=FATAL\nlog4j.appender.mail.BufferSize=10\nlog4j.appender.mail.From = xxx@mail.com\nlog4j.appender.mail.SMTPHost=mail.com\nlog4j.appender.mail.Subject=Log4J Message\nlog4j.appender.mail.To= xxx@mail.com\nlog4j.appender.mail.layout=org.apache.log4j.PatternLayout\nlog4j.appender.mail.layout.ConversionPattern=[%-5p] %d(%r) --\x3e [%t] %l: %m %x %n\n# 应用于数据库\nlog4j.appender.database=org.apache.log4j.jdbc.JDBCAppender\nlog4j.appender.database.URL=jdbc:mysql://localhost:3306/test\nlog4j.appender.database.driver=com.mysql.jdbc.Driver\nlog4j.appender.database.user=root\nlog4j.appender.database.password=\nlog4j.appender.database.sql=INSERT INTO LOG4J (Message) VALUES('=[%-5p] %d(%r) --\x3e [%t] %l: %m %x %n')\nlog4j.appender.database.layout=org.apache.log4j.PatternLayout\nlog4j.appender.database.layout.ConversionPattern=[%-5p] %d(%r) --\x3e [%t] %l: %m %x %n\n\n# 自定义Appender\nlog4j.appender.im = net.cybercorlin.util.logger.appender.IMAppender\nlog4j.appender.im.host = mail.cybercorlin.net\nlog4j.appender.im.username = username\nlog4j.appender.im.password = password\nlog4j.appender.im.recipient = corlin@cybercorlin.net\nlog4j.appender.im.layout=org.apache.log4j.PatternLayout\nlog4j.appender.im.layout.ConversionPattern=[%-5p] %d(%r) --\x3e [%t] %l: %m %x %n` \n")])])]),r("p",[e._v("项目结构如下："),r("br"),e._v(" "),r("img",{attrs:{src:"https://img-blog.csdnimg.cn/201908212022514.png",alt:"在这里插入图片描述"}})]),e._v(" "),r("p",[r("strong",[e._v("第三步")])]),e._v(" "),r("p",[e._v("在Java代码中使用log4j记录项目日志，示例如下：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('import org.apache.log4j.Logger;\n/*\n * 本文作者：谷哥的小弟\n * 博客地址：https://blog.csdn.net/lfdfhl\n */\npublic class TestLog4j {\n\n\tpublic static void main(String[] args) {\n\t\tLogger logger=Logger.getLogger(TestLog4j.class);\n\t\ttry {\n\t\t\tlogger.info("程序开始执行");\n\t\t\tint a=5;\n\t\t\tint b=3;\n\t\t\tint c=a+b;\n\t\t\tSystem.out.println("c="+c);\n\t\t\tint d=a/0;\n\t\t\tSystem.out.println("d="+d);\n\t\t} catch (Exception e) {\n\t\t\tlogger.error(e.toString());\n\t\t}\n\t}\n\n}\n')])])]),r("p",[r("strong",[e._v("第四步")])]),e._v(" "),r("p",[e._v("在指定目录查看日志，图示如下："),r("br"),e._v(" "),r("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190821202838583.jpg",alt:"在这里插入图片描述"}})])])}),[],!1,null,null,null);n.default=o.exports}}]);