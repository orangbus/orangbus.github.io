(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{650:function(e,n,t){"use strict";t.r(n);var a=t(11),r=Object(a.a)({},(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("blockquote",[t("p",[e._v("本文由 "),t("a",{attrs:{href:"http://ksria.com/simpread/",target:"_blank",rel:"noopener noreferrer"}},[e._v("简悦 SimpRead"),t("OutboundLink")],1),e._v(" 转码， 原文地址 "),t("a",{attrs:{href:"http://www.yechuchen.cn/article/20210420203951/",target:"_blank",rel:"noopener noreferrer"}},[e._v("www.yechuchen.cn"),t("OutboundLink")],1)])]),e._v(" "),t("blockquote",[t("p",[e._v("在解决禁止 ip 直接访问网站的问题的时候，受到群友启发，发现还有个可以禁止 ip 直接访问网站的办法，那就是网站黑白名单。")])]),e._v(" "),t("p",[e._v("在解决"),t("a",{attrs:{href:"http://www.yechuchen.cn/article/20210420174143/",target:"_blank",rel:"noopener noreferrer"}},[e._v("禁止 ip 直接访问网站"),t("OutboundLink")],1),e._v("的问题的时候，受到群友启发，发现还有个可以禁止 ip 直接访问网站的办法，那就是网站黑白名单。")]),e._v(" "),t("p",[e._v("创建黑名单其实很简单，只需要使用 allow 或者 deny 关键字就可以了。")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("其中，allow 关键字用来允许访问某 ip, 其中"),t("code",[e._v("allow all")]),e._v("，表示允许所有的 ip")])]),e._v(" "),t("li",[t("p",[e._v("其中，deny 关键字用来拒绝访问某 ip，其中"),t("code",[e._v("deny all")]),e._v("，表示拒绝所有的 ip 进行访问")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("server{\n    listen:80;\n    server_name localhost;\n    deny 192.168.1.10;  #拒绝访问192.168.1.10的ip地址\n    allow 192.168.1.9;  #允许访问192.168.1.9的ip地址\n}\n")])])]),t("p",[e._v("当然如上我所需要的，是禁止通过 IP 访问某个网站，那么只要使用如下代码所示：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("server{\n    listen: 80;\n    server_name www.yechuchen.cn;\n    allow all;#允许访问所有的ip\n    deny 12.345.56.678;#但不允许访问域名所绑定的ip\n}\n")])])]),t("p",[e._v("而要做出网站黑名单，就有可能要屏蔽一堆 ip，但是如果将其放在 nginx.conf 文件夹下，既不美观，也不利于管理，因此需要单独写出一个 blacklist.conf，然后在 nginx.conf 中引用它。")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("blacklist.conf")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("allow all;\ndeny 123.45.678.91;\ndeny 12.345.67.8;\n...\n")])])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("nginx.conf")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("server{\n    listen:80;\n    server_name www.yechuchen.cn;\n    include blacklist.conf; #引用blacklist.conf\n}\n")])])]),t("p",[e._v("配置白名单和配置黑名单其实差不多，只是把 allow 和 deny 反过来罢了，因此这里不细写了，直接贴一个代码")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("whitelist.conf")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("deny all; # 禁止访问所有ip\nallow 192.168.1.10; # 允许访问指定ip\nallow 192.168.1.9; # 允许访问指定ip\n...\n")])])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("nginx.conf")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("server{\n    listen:80;\n    server_name www.yechuchen.cn;\n    include whitelist.conf; #引用whitelistlist.conf\n}\n")])])])])]),e._v(" "),t("h2",{attrs:{id:"http-范围黑名单"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#http-范围黑名单"}},[e._v("#")]),e._v(" HTTP 范围黑名单")]),e._v(" "),t("p",[t("strong",[e._v("总入口黑名单")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http{\n    include blacklist.conf;\n    ...\n    server{\n        ...\n    }\n}\n")])])]),t("p",[e._v("如上所示，在 http 里配置的则是 http 范围的黑名单了。")]),e._v(" "),t("h2",{attrs:{id:"server-范围黑名单"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#server-范围黑名单"}},[e._v("#")]),e._v(" SERVER 范围黑名单")]),e._v(" "),t("p",[t("strong",[e._v("分域名黑名单")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http{\n    ...\n    server{\n        include blacklist.conf;\n        ...\n    }\n}\n")])])]),t("p",[e._v("如上所示，在 server 配置的是 server 范围的黑名单。")]),e._v(" "),t("h2",{attrs:{id:"location-范围黑名单"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#location-范围黑名单"}},[e._v("#")]),e._v(" Location 范围黑名单")]),e._v(" "),t("p",[t("strong",[e._v("分域名黑名单")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http{\n    ...\n    server{\n        ...\n        location /{\n            include blacklist.conf;\n            ...\n        }\n    }\n}\n")])])]),t("p",[e._v("如上，这是 location 范围的黑名单。"),t("br"),e._v("\n从上面不同范围的黑名单可以看出来，不同的范围对应的效果不一样。在 Http 范围的黑名单中，访问该服务器的所有服务都要被黑名单过滤。在 Server 范围黑名单中，只有访问该 http 服务器的当前 server 服务时，才会被黑名单过滤。而 Location 范围呢，自然便是针对当前转发才会被黑名单过滤了。")]),e._v(" "),t("p",[e._v("版权声明: 本博客所有文章除特别声明外，均采用 "),t("a",{attrs:{href:"https://creativecommons.org/licenses/by-nc-sa/4.0/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CC BY-NC-SA 4.0"),t("OutboundLink")],1),e._v(" 许可协议。转载请注明来自 "),t("a",{attrs:{href:"http://www.yechuchen.cn/",target:"_blank",rel:"noopener noreferrer"}},[e._v("夜初尘的博客"),t("OutboundLink")],1),e._v("！")])])}),[],!1,null,null,null);n.default=r.exports}}]);