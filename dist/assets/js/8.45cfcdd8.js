(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{368:function(a,s,t){a.exports=t.p+"assets/img/image-20220812142948774.9fd13562.png"},369:function(a,s,t){a.exports=t.p+"assets/img/image-20220812143204206.d11357cc.png"},370:function(a,s,t){a.exports=t.p+"assets/img/image-20220812143341658.7d377d03.png"},371:function(a,s,t){a.exports=t.p+"assets/img/image-20220812143836769.488b1869.png"},372:function(a,s,t){a.exports=t.p+"assets/img/image-20220812143851283.07095ad1.png"},373:function(a,s,t){a.exports=t.p+"assets/img/image-20220812144017187.f021a0bc.png"},548:function(a,s,t){"use strict";t.r(s);var e=t(11),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("blockquote",[e("p",[a._v("版本要一致")])]),a._v(" "),e("h1",{attrs:{id:"安装："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装："}},[a._v("#")]),a._v(" 安装：")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" pacman -S elasticsearch\n")])])]),e("h1",{attrs:{id:"跨域处理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#跨域处理"}},[a._v("#")]),a._v(" 跨域处理")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" -i\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /etc/elasticsearch\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" elasticsearch.yml\n")])])]),e("p",[a._v("添加")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("http.cors.enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("http.cors.allow-origin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"*"')]),a._v("\n")])])]),e("p",[a._v("启动,默认地址9200")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl start elasticsreach\n")])])]),e("p",[a._v("本机运行多个elasticsearch")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("bin/elasticsearch -E node.name=node1 -E cluster.name=orangbus -E path.data=node1_data\nbin/elasticsearch -E node.name=node2 -E cluster.name=orangbus -E path.data=node2_data\nbin/elasticsearch -E node.name=node3 -E cluster.name=orangbus -E path.data=node3_data\n")])])]),e("p",[a._v("删除进程")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" elasticsearch / "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("kill")]),a._v(" pid\n")])])]),e("p",[a._v("安装可视化工具：elasticsearch-head")]),a._v(" "),e("h1",{attrs:{id:"源码安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#源码安装"}},[a._v("#")]),a._v(" 源码安装")]),a._v(" "),e("p",[a._v("下载：")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.6.2-linux-x86_64.tar.gz\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 解压")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -xzf elasticsearch-8.6.2-linux-x86_64.tar.gz\n")])])]),e("p",[a._v("运行")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建一个es用户")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("useradd")]),a._v(" es\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 切换到es用户")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" es\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 后台启动")]),a._v("\n./bin/elasticsearch -d -p pid\n")])])]),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v(' # 最后会输出这些东西，需要保存一下\n \n Password for the elastic user (reset with `bin/elasticsearch-reset-password -u elastic`):\n  9H5YDoVDwfBU1eSsUD_i\n\nℹ️  HTTP CA certificate SHA-256 fingerprint:\n  b0bd5b1e1b35b53907e4054c393d14939f64a815309a4c22d09bd9f7a13f4ce8\n\nℹ️  Configure Kibana to use this cluster:\n• Run Kibana and click the configuration link in the terminal when Kibana starts.\n• Copy the following enrollment token and paste it into Kibana in your browser (valid for the next 30 minutes):\n  eyJ2ZXIiOiI4LjYuMiIsImFkciI6WyIxMC4wLjAuMzo5MjAwIl0sImZnciI6ImIwYmQ1YjFlMWIzNWI1MzkwN2U0MDU0YzM5M2QxNDkzOWY2NGE4MTUzMDlhNGMyMmQwOWJkOWY3YTEzZjRjZTgiLCJrZXkiOiJ6UDNKVkljQkhDTzJPU29sN3ZPNzp1b0ZkT0lOeVF1LVVLcTlYaUdOZjdRIn0=\n\nℹ️ Configure other nodes to join this cluster:\n• Copy the following enrollment token and start new Elasticsearch nodes with `bin/elasticsearch --enrollment-token <token>` (valid for the next 30 minutes):\n  eyJ2ZXIiOiI4LjYuMiIsImFkciI6WyIxMC4wLjAuMzo5MjAwIl0sImZnciI6ImIwYmQ1YjFlMWIzNWI1MzkwN2U0MDU0YzM5M2QxNDkzOWY2NGE4MTUzMDlhNGMyMmQwOWJkOWY3YTEzZjRjZTgiLCJrZXkiOiJ6djNKVkljQkhDTzJPU29sN3ZPODpXbTFQZzE5TFRkYVIzOU1GMUNCT0x3In0=\n\n  If you\'re running in Docker, copy the enrollment token and run:\n  `docker run -e "ENROLLMENT_TOKEN=<token>" docker.elastic.co/elasticsearch/elasticsearch:8.6.2`\n\n')])])]),e("h2",{attrs:{id:"docker运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker运行"}},[a._v("#")]),a._v(" docker运行")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('docker run -d \\\n    --name elasticsearch \\\n    -p 9200:9200 \\\n    --restart=always \\\n    -e "discovery.type=single-node" \\\n    -e "ES_JAVA_OPTS=-Xmx512m -Xms512m" \\\n    -v /root/Docker/elasticsearch/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml:ro \\\n    -v /root/Docker/elasticsearch/plugins:/usr/share/elasticsearch/plugins \\\ndocker.elastic.co/elasticsearch/elasticsearch:8.7.0\n')])])]),e("h1",{attrs:{id:"docker-composer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-composer"}},[a._v("#")]),a._v(" docker-composer")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# .env\nSTACK_VERSION=8.6.1\nES_PORT=9200\nKIBANA_PORT=5601\nELASTIC_PASSWORD=admin666\n# cerebro 监控\ncerebro_port=5000\n")])])]),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"3.5"')]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("backend")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("driver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" bridge\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("es")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" docker.elastic.co/elasticsearch/elasticsearch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("STACK_VERSION"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("privileged")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" discovery.type=single"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("node\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ES_JAVA_OPTS=-Xmx512m -Xms512m"')]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" ELASTIC_PASSWORD=elastic666 "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# elastic密码")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" ./elasticsearch/elasticsearch.yml"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("/usr/share/elasticsearch/config/elasticsearch.yml"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("rw\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" ./elasticsearch/jvm.options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("/usr/share/elasticsearch/config/jvm.options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("rw\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" ./elasticsearch/plugins"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("/usr/share/elasticsearch/plugins\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" ./data/elasticsearch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("/usr/share/elasticsearch/data\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("ES_PORT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("9200")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"9300:9300"')]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" backend\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kibana")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" docker.elastic.co/kibana/kibana"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("STACK_VERSION"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" ./data/kibana"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("/usr/share/kibana/data\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" ./kibana/kibana.yml"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("/usr/share/kibana/config/kibana.yml"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("rw\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("KIBANA_PORT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("5601")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" SERVERNAME=kibana\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" ELASTICSEARCH_URL=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//es"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("9200")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("depends_on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" es\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("links")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" es\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" backend\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cerebro")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" lmenezes/cerebro\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("container_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cerebro\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"${cerebro_port}:9000"')]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("links")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" es\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("depends_on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" es\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" backend\n")])])]),e("h1",{attrs:{id:"密码设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#密码设置"}},[a._v("#")]),a._v(" 密码设置")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("docker-compose "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" es "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v("\n\n/bin/elasticsearch-reset-password -u elastic -i "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 自定义密码：elastic")]),a._v("\n/bin/elasticsearch-reset-password -u kibana_system -i "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 自定义kibana_system的密码：kibana666")]),a._v("\n")])])]),e("h1",{attrs:{id:"安装kibana"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装kibana"}},[a._v("#")]),a._v(" 安装kibana")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("dc")]),a._v(" up -d kibana\n")])])]),e("h2",{attrs:{id:"插件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#插件"}},[a._v("#")]),a._v(" 插件")]),a._v(" "),e("p",[a._v("下载插件放到"),e("code",[a._v("elasticsreach")]),a._v(" 的"),e("code",[a._v("plugin")]),a._v(" 文件夹即可")]),a._v(" "),e("h2",{attrs:{id:"查看已安装插件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看已安装插件"}},[a._v("#")]),a._v(" 查看已安装插件")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("/bin/elasticsearch-plugin list\n")])])]),e("h2",{attrs:{id:"安装插件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装插件"}},[a._v("#")]),a._v(" 安装插件")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("/bin/elasticsearch-plugin "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" analysis-icu\nbin/kibana-plugin "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" plugin_location\nbin/kibana-plugin list\nbin/kibana-plugin remove\n")])])]),e("h2",{attrs:{id:"ik分词器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ik分词器"}},[a._v("#")]),a._v(" ik分词器")]),a._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[a._v("GET _analyze\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"analyzer"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"user"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"text"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"orange"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),e("h2",{attrs:{id:"项目升级初探elasticsearch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目升级初探elasticsearch"}},[a._v("#")]),a._v(" 项目升级初探elasticsearch")]),a._v(" "),e("h3",{attrs:{id:"环境准备："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#环境准备："}},[a._v("#")]),a._v(" 环境准备：")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("laradock")])]),a._v(" "),e("li",[e("p",[a._v("elasticsearch：7.13.2")])]),a._v(" "),e("li",[e("p",[a._v("ik：7.13.2")])])]),a._v(" "),e("p",[a._v("修改elasticsearch版本")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" laradock/.env\n\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ELK_VERSION")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("7.13")]),a._v(".2\n")])])]),e("h3",{attrs:{id:"安装ik分词器："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装ik分词器："}},[a._v("#")]),a._v(" 安装ik分词器：")]),a._v(" "),e("p",[a._v("下载ik分词插件到elasticsearch目录：")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" laradock/elasticsearch/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" plugins\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" plugins "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/medcl/elasticsearch-analysis-ik/archive/refs/tags/v7.13.2.tar.gz\n")])])]),e("p",[a._v("修改elasticsearch 的Dockerfile文件")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" laradock/elasticsearch/Dockerfile\n")])])]),e("div",{staticClass:"language-dockerfile extra-class"},[e("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ARG")]),a._v(" ELK_VERSION=7.13.2\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" docker.elastic.co/elasticsearch/elasticsearch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("ELK_VERSION"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COPY")]),a._v(" ./plugins/v7.13.2.tar.gz /usr/share/elasticsearch/plugins\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("EXPOSE")]),a._v(" 9200 9300\n")])])]),e("p",[a._v("重新buildelasticsearch")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("docker-compose build elasticsearch\n")])])]),e("p",[a._v("检查是否安装成功")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("docker-compose "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" elasticsearch /usr/share/elasticsearch/bin/elasticsearch-plugin list\n")])])]),e("h3",{attrs:{id:"安装elasticsearch相关的扩展"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装elasticsearch相关的扩展"}},[a._v("#")]),a._v(" 安装elasticsearch相关的扩展")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("\n")])])]),e("h2",{attrs:{id:"kibana配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kibana配置"}},[a._v("#")]),a._v(" Kibana配置")]),a._v(" "),e("p",[a._v("启动")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("dc up -d kibana\n")])])]),e("p",[a._v("查看kibaba日志，这个时候会提示你访问 "),e("code",[a._v("Go to http://0.0.0.0:5601/?code=679455 to get started")]),a._v(" 进行初始化")]),a._v(" "),e("p",[e("img",{attrs:{src:t(368),alt:"image-20220812142948774"}})]),a._v(" "),e("p",[a._v("打开浏览器：输入提示的地址："),e("code",[a._v("http://0.0.0.0:5601/?code=679455")])]),a._v(" "),e("p",[e("img",{attrs:{src:t(369),alt:"image-20220812143204206"}})]),a._v(" "),e("p",[e("img",{attrs:{src:t(370),alt:"image-20220812143341658"}})]),a._v(" "),e("p",[a._v("这个时候需要进行验证，这里的验证码可以去kibana日志里面去找到")]),a._v(" "),e("p",[e("img",{attrs:{src:t(371),alt:"image-20220812143836769"}})]),a._v(" "),e("p",[e("img",{attrs:{src:t(372),alt:"image-20220812143851283"}})]),a._v(" "),e("p",[a._v("输入完成后，可能出现一下情况，重启一下整个应用就好了，或者看看是不是因为kibana配置文件没有权限。")]),a._v(" "),e("p",[e("img",{attrs:{src:t(373),alt:"image-20220812144017187"}})]),a._v(" "),e("p",[a._v("至此kibaba就配置成功了。")]),a._v(" "),e("h1",{attrs:{id:"curd"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#curd"}},[a._v("#")]),a._v(" curd")]),a._v(" "),e("h2",{attrs:{id:"索引操作（表）"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#索引操作（表）"}},[a._v("#")]),a._v(" 索引操作（表）")]),a._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[a._v("# 创建索引\nPUT /jokes\n\n# 获取索引\nGET /jokes\n\n# 删除索引\nDELETE /jokes\n\n# 关闭索引\nPOST /jokes/_close\n\n# 开启索引\nPOST /jokes/_open\n\n# 重建索引\nPOST _reindex\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"source"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"index"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jokes2"')]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n# 查看所有索引\nGET /_cat/indices/?v&pretty\n\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 查看索引分词")]),a._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 设置分片信息")]),a._v("\nPUT /jokes/_settings\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"settings"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"number_of_replicas"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 设置分词器")]),a._v("\nPUT /jokes\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"settings"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"index"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"anlysis.analyzer.default.type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ik_max_word"')]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),e("h2",{attrs:{id:"文档操作（每一条数据）"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#文档操作（每一条数据）"}},[a._v("#")]),a._v(" 文档操作（每一条数据）")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('# 添加文档\nPUT user/_doc/1\n{\n  "name":"orangbus",\n  "age":18\n}\n\n# 编辑文档\nPOST user/_doc/1\n{\n  "name":"orangbus",\n  "age":20\n}\n\n# 查看文档\nGET user/_doc/1\n\n\n# 删除文档\nDELETE user/_doc/1\n\n# 文档搜索\nGET user/_search\n{\n  "query": {\n    "match": {\n      "age": 18\n    }\n  }\n}\n')])])]),e("h1",{attrs:{id:"elasticsearch做成systemctl服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch做成systemctl服务"}},[a._v("#")]),a._v(" Elasticsearch做成systemctl服务")]),a._v(" "),e("h2",{attrs:{id:"一、添加elasticsearch基本信息的配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、添加elasticsearch基本信息的配置文件"}},[a._v("#")]),a._v(" 一、添加elasticsearch基本信息的配置文件")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("vim /etc/sysconfig/elasticsearch-1   #elasticsearch-1 这个名字任意定义，因为我服务器中有多个es所以加-1进行命名。\n")])])]),e("p",[a._v("将下列内容添加到elasticsearch-1中")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("#es的目录文件地址\nES_HOME=/data/es-cluster/elasticsearch-7.9.2-1\n#Java的目录文件地址（这里我就用es7中自带的jdk）\nJAVA_HOME=/data/es-cluster/elasticsearch-7.9.2-1/jdk\n#es中的config文件的地址  \nES_PATH_CONF=/data/es-cluster/elasticsearch-7.9.2-1/config\n#运行es进程的地址（这里需要注意由于es启动的时候非root用户启动 所以你配置的目录es用户要有写如的权限）\nPID_DIR=/data/es-cluster/elasticsearch-7.9.2-1/run/elasticsearch-1\nES_STARTUP_SLEEP_TIME=5\n")])])]),e("h2",{attrs:{id:"二、编写控制elasticsearch启动的service文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、编写控制elasticsearch启动的service文件"}},[a._v("#")]),a._v(" 二、编写控制elasticsearch启动的service文件")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("vim /usr/lib/systemd/system/elasticsearch-1.service   #elasticsearch-1.service这个名字根据喜好定义，后续需要这个名字来进行启动关闭。\n")])])]),e("p",[a._v("将下列内容添加到elasticsearch-1.service中")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("[Unit]\nDescription=Elasticsearch\nDocumentation=http://www.elastic.co\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nEnvironment=ES_HOME=/data/es-cluster/elasticsearch-7.9.2-1\nEnvironment=ES_PATH_CONF=/data/es-cluster/elasticsearch-7.9.2-1/config\nEnvironment=PID_DIR=/data/es-cluster/elasticsearch-7.9.2-1/run/elasticsearch-1\nEnvironmentFile=/etc/sysconfig/elasticsearch-1\nWorkingDirectory=/data/es-cluster/elasticsearch-7.9.2-1\n#启动的用户\nUser=es\n#启动的用户组\nGroup=es\n#启动线程地址\nExecStart=/data/es-cluster/elasticsearch-7.9.2-1/bin/elasticsearch -p ${PID_DIR}/elasticsearch.pid\n\n#下列这些如无特殊情况，不需要进行修改直接进行复制就行\nStandardOutput=journal\nStandardError=inherit\n\n# Specifies the maximum file descriptor number that can be opened by this process\nLimitNOFILE=65536\n\n# Specifies the maximum number of process\nLimitNPROC=4096\n\n# Specifies the maximum size of virtual memory\nLimitAS=infinity\n\n# Specifies the maximum file size\nLimitFSIZE=infinity\n\n# Disable timeout logic and wait until process is stopped\nTimeoutStopSec=0\n\n# SIGTERM signal is used to stop the Java process\nKillSignal=SIGTERM\n\n# Send the signal only to the JVM rather than its control group\nKillMode=process\n\n# Java process is never killed\nSendSIGKILL=no\n\n# When a JVM receives a SIGTERM signal it exits with code 143\nSuccessExitStatus=143\n \n[Install]\nWantedBy=multi-user.target\n")])])]),e("p",[a._v("添加可执行权限")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("chmod +x /usr/lib/systemd/system/elasticsearch-1.service\n")])])]),e("p",[a._v("重新加载systemctl服务配置文件")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("systemctl daemon-reload\n")])])]),e("h2",{attrs:{id:"三、服务开启关闭自启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、服务开启关闭自启动"}},[a._v("#")]),a._v(" 三、服务开启关闭自启动")]),a._v(" "),e("p",[a._v("启动")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("systemctl start elasticsearch-1.service\n")])])]),e("p",[a._v("关闭")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("systemctl stop elasticsearch-1.service\n")])])]),e("p",[a._v("重启")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("systemctl restart elasticsearch-1.service\n")])])]),e("p",[a._v("开机自启动")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("systemctl enable elasticsearch-1.service\n")])])]),e("h1",{attrs:{id:"filebeat：8-7-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#filebeat：8-7-0"}},[a._v("#")]),a._v(" Filebeat：8.7.0")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rpm")]),a._v(" --import https://packages.elastic.co/GPG-KEY-elasticsearch\n")])])]),e("p",[a._v("编辑 "),e("code",[a._v("/etc/yum.repos.d/elastic-filebeat.repo")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("[elastic-8.x]\nname=Elastic repository for 8.x packages\nbaseurl=https://artifacts.elastic.co/packages/8.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=1\nautorefresh=1\ntype=rpm-md\n")])])]),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sudo yum install filebeat\n\nsudo systemctl enable|start filebeat\n")])])]),e("p",[a._v("默认目录")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("Type")]),a._v(" "),e("th",[a._v("Description")]),a._v(" "),e("th",[a._v("Location")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[e("strong",[a._v("home")])]),a._v(" "),e("td",[a._v("Home of the Filebeat installation.")]),a._v(" "),e("td",[e("code",[a._v("/usr/share/filebeat")])])]),a._v(" "),e("tr",[e("td",[e("strong",[a._v("bin")])]),a._v(" "),e("td",[a._v("The location for the binary files.")]),a._v(" "),e("td",[e("code",[a._v("/usr/share/filebeat/bin")])])]),a._v(" "),e("tr",[e("td",[e("strong",[a._v("config")])]),a._v(" "),e("td",[a._v("The location for configuration files.")]),a._v(" "),e("td",[e("code",[a._v("/etc/filebeat")])])]),a._v(" "),e("tr",[e("td",[e("strong",[a._v("data")])]),a._v(" "),e("td",[a._v("The location for persistent data files.")]),a._v(" "),e("td",[e("code",[a._v("/var/lib/filebeat")])])]),a._v(" "),e("tr",[e("td",[e("strong",[a._v("logs")])]),a._v(" "),e("td",[a._v("The location for the logs created by Filebeat.")]),a._v(" "),e("td",[e("code",[a._v("/var/log/filebeat")])])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);